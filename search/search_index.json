{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CovidRt.jl \u00b6 CovidRt.CovidRt CovidRt.lagdiff CovidRt.smooth # CovidRt.CovidRt \u2014 Module . module CovidRt Compute time and area specific estimates of the reproductive number of Covid. source # CovidRt.lagdiff \u2014 Function . function lagdiff(x::AbstractVector, d=1) Returns out[i] = x[i] - x[i-d] with out padded with missings so that length(out)==length(x) . source # CovidRt.smooth \u2014 Method . function smooth(x::AbstractVector; w=pdf(Normal(), range(-3, 3, length=7))) Returns the running weighted mean of x*w. When n=length(w) , then out[i] = sum(x[i - n\u00f72 + j-1] * w[j] for j in 1:n)/sum(w) . source","title":"Package Docs"},{"location":"#covidrtjl","text":"CovidRt.CovidRt CovidRt.lagdiff CovidRt.smooth # CovidRt.CovidRt \u2014 Module . module CovidRt Compute time and area specific estimates of the reproductive number of Covid. source # CovidRt.lagdiff \u2014 Function . function lagdiff(x::AbstractVector, d=1) Returns out[i] = x[i] - x[i-d] with out padded with missings so that length(out)==length(x) . source # CovidRt.smooth \u2014 Method . function smooth(x::AbstractVector; w=pdf(Normal(), range(-3, 3, length=7))) Returns the running weighted mean of x*w. When n=length(w) , then out[i] = sum(x[i - n\u00f72 + j-1] * w[j] for j in 1:n)/sum(w) . source","title":"CovidRt.jl"},{"location":"Rt/","text":"This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License Model \u00b6 Following Kevin Systrom , we adapt the approach of (Bettencourt 2008 ) to compute real-time rolling estimates of pandemic parameters. (Bettencourt 2008 ) begin from a SIR model, \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I \\\\ \\dot{R} & = \\gamma I \\end{align*} To this we add the possibility that not all cases are known. Cases get get detected at rate $I$, so cumulative confirmed cases, $C$, evolves as \\dot{C} = \\tau I Question Should we add other states to this model? If yes, how? I think using death and hospitalization numbers in estimation makes sense. The number of new confirmed cases from time $t$ to $t+\\delta$ is then: We will allow for the testing rate, $\\tau$, and infection rate, $\\beta$, to vary over time. k_t \\equiv \\frac{C(t+\\delta) - C(t)}{\\delta} = \\int_t^{t+\\delta} \\tau(s) I(s) ds \\approx \\tau(t) I(t) As in (Bettencourt 2008 ), \\begin{align*} I(t) = & I(t-\\delta) \\int_{t-\\delta}^{t} e^{\\frac{S(s)}{N} \\beta(s) - \\gamma} ds \\\\ \\approx & I(t-\\delta) e^{\\delta \\left( \\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma \\right)} \\end{align*} Note The reproductive number is: $R_t \\equiv \\frac{S(t)}{N}\\frac{\\beta(t)}{\\gamma}$. Substituting the expression for $I_t$ into $k_t$, we have \\begin{align*} k_t \\approx & \\tau(t) I(t-\\delta) e^{\\delta \\left( \\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma\\right)} \\\\ \\approx & k_{t-\\delta} \\frac{\\tau(t)}{\\tau(t-\\delta)} e^{\\delta \\left(\\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma \\right)} \\end{align*} Data \u00b6 We use data as on US states on Covid cases, deaths, policies, and other variables. The data combines information on Daily case counts and deaths from NYTimes Daily Hospitalizations, recoveries, and testing from the Covid Tracking Project Covid related policy changes from Raifman et al Movements from Google Mobility Reports Hourly workers from Hoembase Statistical Model \u00b6 The above theoretical model gives a deterministic relationship between $k_t$ and $k_{t-1}$ given the parameters. To bring it to data we must add stochasticity. Systrom\u2019s approach \u00b6 First we describe what Systrom does. He assumes that $R_{0} \\sim Gamma(4,1)$. Then for $t=1, \u2026, T$, he computes $P(R_t|k_{t}, k_{t-1}, \u2026 ,k_0)$ iteratively using Bayes\u2019 rules. Specifically, he assumes k_t | R_t, k_{t-1}, ... \\sim Poisson(k_{t-1} e^{\\gamma(R_t - 1)}) and that $R_t$ follows a random walk, so the prior of $R_t | R_{t-1}$ is R_t | R_{t-1} \\sim N(R_{t-1}, \\sigma^2) so that P(R_t|k_{t}, k_{t-1}, ... ,k_0) = \\frac{P(k_t | R_t, k_{t-1}) P(R_t | R_{t-1}) P(R_{t-1} | k_{t-1}, ...)} {P(k_t)} Note that this computes posteriors of $R_t$ given current and past cases. Future cases are also informative of $R_t$, and you could instead compute $P(R_t | k_0, k_1, \u2026, k_T)$. The notebook makes some mentions of Gaussian processes. There\u2019s likely some way to recast the random walk assumption as a Gaussian process prior (the kernel would be $\\kappa(t,t\u2019) = \\min{t,t\u2019} \\sigma^2$), but that seems to me like an unusual way to describe it. Code \u00b6 Let\u2019s see how Systrom\u2019s method works. First the load data. using Pkg try using CovidData catch pkg\"registry add https://github.com/schrimpf/julia-registry.git\" Pkg.develop(\"CovidData\") Pkg.develop(\"CovidRt\") end using DataFrames, Plots, StatsPlots, CovidRt, CovidData Plots.pyplot() df = CovidData.statedata() df = filter(x->x.fips<60, df) # focus on 10 states with most cases as of April 1, 2020 sdf = select(df[df[!,:date].==Dates.Date(\"2020-04-01\"),:], Symbol(\"cases.nyt\"), :state) |> x->sort(x,Symbol(\"cases.nyt\"), rev=true) states=sdf[1:10,:state] sdf = select(filter(r->r[:state] \u2208 states, df), Symbol(\"cases.nyt\"), :state, :date) sdf = sort(sdf, [:state, :date]) sdf[!,:newcases] = by(sdf, :state, newcases = Symbol(\"cases.nyt\") => x->(vcat(missing, diff(x))))[!,:newcases] figs = [] for gdf in groupby(sdf, :state) f = @df gdf plot(:date, :newcases, legend=:none, linewidth=2, title=unique(gdf.state)[1]) global figs = vcat(figs,f) end display(plot(figs[1:9]..., layout=(3,3))) From this we can see that new cases are very noisy. This is especially problematic when cases jump from near 0 to very high values, such as in Illinois. The median value of and variance of new cases, $k_t$, are both $k_{t-1} e^{\\gamma(R_t - 1)}$. Only huge changes in $R_t$ can rationalize huge jumps in new cases. Let\u2019s compute posteriors for each state. using Interpolations, Distributions function rtpost(cases, \u03b3, \u03c3, prior0, casepdf) (rgrid, postgrid, ll) = rtpostgrid(cases)(\u03b3, \u03c3, prior0, casepdf) w = rgrid[2] - rgrid[1] T = length(cases) p = [LinearInterpolation(rgrid, postgrid[:,t]) for t in 1:T] coverage = 0.9 cr = zeros(T,2) mu = vec(rgrid' * postgrid*w) for t in 1:T l = findfirst(cumsum(postgrid[:,t].*w).>(1-coverage)/2) h = findlast(cumsum(postgrid[:,t].*w).<(1-(1-coverage)/2)) if !(l === nothing || h === nothing) cr[t,:] = [rgrid[l], rgrid[h]] end end return(p, mu, cr) end function rtpostgrid(cases) # We'll compute the posterior on these values of R_t rlo = 0 rhi = 8 steps = 500 rgrid = range(rlo, rhi, length=steps) \u0394grid = range(0.05, 0.95, length=10) w = rgrid[2] - rgrid[1] dr = rgrid .- rgrid' fn=function(\u03b3, \u03c3, prior0, casepdf) prr = pdf.(Normal(0,\u03c3), dr) # P(r_{t+1} | r_t) for i in 1:size(prr,1) prr[i, : ] ./= sum(prr[i,:].*w) end postgrid = Matrix{typeof(\u03c3)}(undef,length(rgrid), length(cases)) # P(R_t | k_t, k_{t-1},...) like = similar(postgrid, length(cases)) for t in 1:length(cases) if (t==1) postgrid[:,t] .= prior0.(rgrid) else if (cases[t-1]===missing || cases[t]===missing) pkr = 1 # P(k_t | R_t) else \u03bb = max(cases[t-1],1).* exp.(\u03b3 .* (rgrid .- 1)) #r = \u03bb*nbp/(1-nbp) #pkr = pdf.(NegativeBinomial.(r,nbp), cases[t]) pkr = casepdf.(\u03bb, cases[t]) if (all(pkr.==0)) @warn \"all pkr=0\" #@show t, cases[t], cases[t-1] pkr .= 1 end end postgrid[:,t] = pkr.*(prr*postgrid[:,t-1]) like[t] = sum(postgrid[:,t].*w) postgrid[:,t] ./= max(like[t], 1e-15) end end ll = try sum(log.(like)) catch -710*length(like) end return((rgrid, postgrid, ll)) end return(fn) end for \u03c3 in [0.1, 0.25, 1] \u03b3 =1/7 nbp = 0.01 figs = [] for gdf in groupby(sdf, :state) p, m, cr = rtpost(gdf.newcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(Poisson(\u03bb),x)) f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Poisson & \u03c3=$\u03c3\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l)) end In these results, what is happening is that when new cases fluctuate too much, the likelihood is identically 0, causing the posterior calculation to break down. Increasing the variance of changes in $R_t$, widens the posterior confidence intervals, but does not solve the problem of vanishing likelihoods. One thing that can \u201csolve\u201d the problem is choosing a distribution of $k_t | \\lambda, k_{t-1}$ with higher variance. The negative binomial with parameters $\\lambda p/(1-p)$ and $p$ has mean $\\lambda$ and variance $\\lambda/p$. \u03b3 =1/7 \u03c3 = 0.25 Plots.closeall() for \u03c3 in [0.1, 0.25, 0.5] for nbp in [0.5, 0.1, 0.01] figs = [] for gdf in groupby(sdf, :state) p, m, cr = rtpost(gdf.newcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(NegativeBinomial(\u03bb*nbp/(1-nbp), nbp),x)); f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Negative binomial, p=$nbp, & \u03c3=$\u03c3\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l, reuse=false)) end end What Systrom did was smooth the new cases before using the Poisson distribution. He used a window width of $7$ and Gaussian weights with standard deviation $2$. \u03c3 = 0.25 Plots.closeall() for w in [3, 7, 11] for s in [0.5, 2, 4] \u03b3 =1/7 nbp = 0.01 figs = [] for gdf in groupby(sdf, :state) windowsize = w weights = pdf(Normal(0, s), -floor(windowsize/2):floor(windowsize/2)) weights = weights/sum(weights) smoothcases = smooth(gdf.newcases, w=weights) p, m, cr = rtpost(smoothcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(Poisson(\u03bb),x)) f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Poisson & \u03c3=$\u03c3, s=$s, w=$w\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l, reuse=false)) end end Here we see that we can get a variety of results depending on the smoothing used. All of these posteriors ignore the uncertainty in the choice of smoothing parameters (and procedure). An alternative approach \u00b6 Here we follow an approach similar in spirit to Systrom, with a few modifications and additions. The primary modification is that we alter the model of $k_t|k_{t-1}, R_t$ to allow measurement error in both $k_t$ and $k_{t-1}$. We make four additions. First, we utilize data on movement and business operations as auxillary noisy measures of $R_t$. Second, we allow state policies to shift the mean of $R_t$. Third, we combine data from all states to improve precision in each. Fourth, we incorporate testing numbers into the data. As above, we begin from the approximation k^*_{s,t} \\approx k^*_{s,t-1} \\frac{\\tau_{s,t}}{\\tau_{s,t-1}} e^{\\gamma(R_{st} - 1)}) where $k^*$ is the true, unobserved number of new cases. Taking logs and rearranging we have \\log(k^*_{s,t}) - \\log(k^*_{s,t-1}) = \\gamma(R_{s,t} - 1) + \\log\\left(\\frac{\\tau_{s,t}}{\\tau_{s,t-1}}\\right) Let $k_{s,t}$ be the noisy observed value of $k^*_{s,t}$, then \\log(k_{s,t}) - \\log(k_{s,t-1}) = \\gamma(R_{s,t} - 1) + \\log\\left(\\frac{\\tau_{s,t}}{\\tau_{s,t-1}}\\right) - \\epsilon_{s,t} + \\epsilon_{s,t-1} where \\log(k^*_{s,t}) = \\log(k_{s,t}) +\\epsilon_{s,t} and $\\epsilon_{s,t}$ is measurement error. With appropriate assumptions on $\\epsilon$, $\\tau$, $R$ and other observables, we can then use regression to estimate $R$. As a simple example, let\u2019s assume $R_{s,t} = R_{s,0} + \\alpha d_{s,t}$ where $d_{s,t}$ are indicators for NPI\u2019s being in place. That $\\tau_{s,t}$ is constant over time for each $s$ $E[\\epsilon_{s,t} - \\epsilon_{s,t-1}|d] = 0$ and $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ is uncorrelated over time (just to simplify; this is not a good assumption). ```{=html} ``` julia using GLM, RegressionTables pvars = [Symbol(\"Stay.at.home..shelter.in.place\"), Symbol(\"State.of.emergency\"), Symbol(\"Date.closed.K.12.schools\"), Symbol(\"Closed.gyms\"), Symbol(\"Closed.movie.theaters\"), Symbol(\"Closed.day.cares\"), Symbol(\"Date.banned.visitors.to.nursing.homes\"), Symbol(\"Closed.non.essential.businesses\"), Symbol(\"Closed.restaurants.except.take.out\")] sdf = copy(df) for p in pvars sdf[!,p] = by(sdf, :state, (:date, p) => x->(!ismissing(unique(x[p])[1]) .& (x.date .>= unique(x[p])[1]))).x1 end sdf = sort(sdf, [:state, :date]) sdf[!,:newcases] = by(sdf, :state, newcases = Symbol(\"cases.nyt\") => x->(vcat(missing, diff(x))))[!,:newcases] sdf[!,:dlogk] = by(sdf, :state, dlogk = :newcases => x->(vcat(missing, diff(log.(max.(x,0.1))))))[!,:dlogk] fmla = FormulaTerm(Term(:dlogk), Tuple(Term.(vcat(pvars,:state)))) reg = lm(fmla, sdf) regtable(reg, renderSettings=asciiOutput()) ----------------------------------------------- dlogk ------- (1) ----------------------------------------------- (Intercept) 0.175 (0.171) Stay.at.home..shelter.in.place 0.009 (0.060) State.of.emergency -0.093 (0.077) Date.closed.K.12.schools 0.047 (0.081) Closed.gyms -0.080 (0.120) Closed.movie.theaters 0.111 (0.127) Closed.day.cares 0.100 (0.056) Date.banned.visitors.to.nursing.homes -0.009 (0.047) Closed.non.essential.businesses -0.060 (0.069) Closed.restaurants.except.take.out -0.072 (0.107) state: Alaska 0.012 (0.227) state: Arizona -0.023 (0.198) state: Arkansas -0.037 (0.226) state: California -0.025 (0.197) state: Colorado -0.002 (0.219) state: Connecticut 0.032 (0.222) state: Delaware 0.024 (0.225) state: District of Columbia 0.052 (0.221) state: Florida 0.067 (0.216) state: Georgia 0.059 (0.217) state: Hawaii -0.025 (0.220) state: Idaho -0.036 (0.228) state: Illinois 0.007 (0.197) state: Indiana 0.089 (0.220) state: Iowa 0.014 (0.222) state: Kansas 0.073 (0.221) state: Kentucky 0.071 (0.220) state: Louisiana -0.001 (0.223) state: Maine -0.019 (0.227) state: Maryland 0.083 (0.219) state: Massachusetts 0.020 (0.200) state: Michigan 0.112 (0.224) state: Minnesota 0.073 (0.220) state: Mississippi 0.078 (0.226) state: Missouri 0.063 (0.221) state: Montana -0.089 (0.228) state: Nebraska 0.002 (0.207) state: Nevada 0.041 (0.219) state: New Hampshire -0.020 (0.217) state: New Jersey 0.048 (0.218) state: New Mexico 0.006 (0.226) state: New York 0.088 (0.216) state: North Carolina 0.057 (0.218) state: North Dakota 0.047 (0.226) state: Ohio 0.080 (0.224) state: Oklahoma 0.040 (0.221) state: Oregon -0.004 (0.215) state: Pennsylvania 0.028 (0.221) state: Rhode Island 0.036 (0.216) state: South Carolina 0.036 (0.221) state: South Dakota -0.035 (0.225) state: Tennessee 0.050 (0.220) state: Texas -0.018 (0.205) state: Utah 0.011 (0.212) state: Vermont 0.002 (0.222) state: Virginia 0.051 (0.222) state: Washington -0.022 (0.196) state: West Virginia -0.009 (0.234) state: Wisconsin -0.004 (0.201) state: Wyoming 0.015 (0.226) ----------------------------------------------- Estimator OLS ----------------------------------------------- N 2,876 R2 0.004 ----------------------------------------------- From this we get that if we assume $\\gamma = 1/7$, then the the baseline estimate of $R$ in Illinois is $7(0.046 + 0.034) + 1\\approx 1.56$ with a stay at home order, $R$ in Illinois becomes $7(0.046 + 0.035 - 0.147) + 1 \\approx 0.53$. Some of the policies have positive coefficient estimates, which is strange. This is likely due to assumption 1 being incorrect. There is likely an unobserved component of $R_{s,t}$ that is positively correlated with policy indicators. State space model \u00b6 A direct analog of Systrom\u2019s approach is to treat $R_{s,t}$ as an unobserved latent process. Specifically, we will assume that \\begin{align*} \\tilde{R}_{s,0} & \\sim N(\\alpha_0, \\sigma^2_{R,0}) \\\\ \\tilde{R}_{s,t} & = \\rho \\tilde{R}_{s,t} + u_{s,t} \\;,\\; u_{s,t} \\sim N(0, \\sigma^2_R) \\\\ R_{s,t} & = \\alpha + \\tilde{R}_{s,t} \\\\ \\Delta \\log(k)_{s,t} & = \\gamma (R_{s,t} - 1) + \\epsilon_{s,t} - \\epsilon_{s,t-1} \\;, \\; \\epsilon_{s,t} \\sim N(0, \\sigma^2_k) \\end{align*} Note that the Poisson assumption on the distribution of $k_{s,t}$ used by Systrom implies an extremely small $\\sigma^2_k$, since the variance of log Poisson($\\lambda$) distribution is $1/\\lambda$. If $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ weere independent over $t$, we could compute the likelihood and posteriors of $R_{s,t}$ through the standard Kalman filter. Of course, $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ is not independent over time, so we must adjust the Kalman filter accordingly. We follow the approach of (Kurtz and Lin 2019 ) to make this adjustment. Question Is there a better reference? I\u2019m sure someone did this much earlier than 2019\u2026 We estimate the parameters using data from US states. We set time 0 as the first day in which a state had at least 10 cumulative cases. We then compute posteriors for the parameters by MCMC. We place the following priors on the parameters. using Distributions, TransformVariables, DynamicHMC, MCMCChains, Plots, StatsPlots, LogDensityProblems, Random, LinearAlgebra, JLD2 rlo=-1 rhi=1.1 priors = (\u03b3 = truncated(Normal(1/7,1/7), 1/28, 1/1), \u03c3R0 = truncated(Normal(1, 3), 0, Inf), \u03b10 = MvNormal([1], 3), \u03c3R = truncated(Normal(0.25,1),0,Inf), \u03c3k = truncated(Normal(0.1, 5), 0, Inf), \u03b1 = MvNormal([1], 3), \u03c1 = Uniform(rlo, rhi)) (\u03b3 = Truncated(Distributions.Normal{Float64}(\u03bc=0.14285714285714285, \u03c3=0.142 85714285714285), range=(0.03571428571428571, 1.0)), \u03c3R0 = Truncated(Distrib utions.Normal{Float64}(\u03bc=1.0, \u03c3=3.0), range=(0.0, Inf)), \u03b10 = IsoNormal( dim: 1 \u03bc: [1.0] \u03a3: [9.0] ) , \u03c3R = Truncated(Distributions.Normal{Float64}(\u03bc=0.25, \u03c3=1.0), range=(0.0, Inf)), \u03c3k = Truncated(Distributions.Normal{Float64}(\u03bc=0.1, \u03c3=5.0), range=(0 .0, Inf)), \u03b1 = IsoNormal( dim: 1 \u03bc: [1.0] \u03a3: [9.0] ) , \u03c1 = Distributions.Uniform{Float64}(a=-1.0, b=1.1)) The estimation is fast and the chain appears to mix well. reestimate=false sdf = sort(sdf, (:state, :date)); dlogk = [filter(x->((x.state==st) .& (x.cases .>=10)), sdf).dlogk for st in unique(sdf.state)]; dates = [filter(x->((x.state==st) .& (x.cases .>=10)), sdf).date for st in unique(sdf.state)]; mdl = RtModel(dlogk, priors) trans = as( (\u03b3 = as\u211d\u208a, \u03c3R0 = as\u211d\u208a, \u03b10 = as(Array, 1), \u03c3R = as\u211d\u208a, \u03c3k = as\u211d\u208a, \u03b1 = as(Array,1), \u03c1=as(Real, rlo, rhi)) ) P = TransformedLogDensity(trans, mdl) \u2207P = ADgradient(:ForwardDiff, P) p0 = (\u03b3 = 1/7, \u03c3R0=1.0, \u03b10=[4.0],\u03c3R=0.25, \u03c3k=2.0, \u03b1=[1], \u03c1=0.9) x0 = inverse(trans,p0) @time LogDensityProblems.logdensity_and_gradient(\u2207P, x0); 3.330265 seconds (6.58 M allocations: 327.353 MiB, 4.54% gc time) rng = MersenneTwister() steps = 100 warmup=default_warmup_stages(local_optimization=nothing, stepsize_search=nothing, init_steps=steps, middle_steps=steps, terminating_steps=2*steps, doubling_stages=3, M=Symmetric) x0 = x0 if (!isfile(\"rt1.jld2\") || reestimate) res = DynamicHMC.mcmc_keep_warmup(rng, \u2207P, 2000;initialization = (q = x0, \u03f5=0.1), reporter = LogProgressReport(nothing, 25, 15), warmup_stages =warmup); post = transform.(trans,res.inference.chain) @save \"rt1.jld2\" post end @load \"rt1.jld2\" post p = post[1] vals = hcat([vcat([length(v)==1 ? v : vec(v) for v in values(p)]...) for p in post]...)' vals = reshape(vals, size(vals)..., 1) names = vcat([length(p[s])==1 ? String(s) : String.(s).*\"[\".*string.(1:length(p[s])).*\"]\" for s in keys(p)]...) cc = MCMCChains.Chains(vals, names) display(cc) Object of type Chains, with data of type 2000\u00d77\u00d71 reshape(::LinearAlgebra.A djoint{Float64,Array{Float64,2}}, 2000, 7, 1) with eltype Float64 Iterations = 1:2000 Thinning interval = 1 Chains = 1 Samples per chain = 2000 parameters = \u03b3, \u03c3R0, \u03b10, \u03c3R, \u03c3k, \u03b1, \u03c1 2-element Array{MCMCChains.ChainDataFrame,1} Summary Statistics parameters mean std naive_se mcse ess r_hat \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u03b3 0.0919 0.0339 0.0008 0.0017 455.3275 1.0009 \u03c3R0 1.0223 0.6973 0.0156 0.0317 673.2799 0.9996 \u03b10 5.1918 1.7792 0.0398 0.0909 401.6285 1.0001 \u03c3R 0.0887 0.0735 0.0016 0.0027 821.3143 1.0004 \u03c3k 0.5507 0.0082 0.0002 0.0001 3009.0575 0.9997 \u03b1 0.4512 0.4386 0.0098 0.0249 307.9202 0.9996 \u03c1 0.9394 0.0122 0.0003 0.0005 787.5179 1.0002 Quantiles parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u03b3 0.0451 0.0665 0.0849 0.1101 0.1721 \u03c3R0 0.0534 0.5141 0.8979 1.3925 2.7113 \u03b10 2.4360 3.8546 4.9722 6.3808 9.1091 \u03c3R 0.0028 0.0327 0.0722 0.1248 0.2819 \u03c3k 0.5345 0.5453 0.5505 0.5560 0.5677 \u03b1 -0.5931 0.2494 0.5305 0.7539 1.0493 \u03c1 0.9140 0.9315 0.9402 0.9481 0.9618 display(plot(cc)) The posterior for the initial distribution of $R_{0,s}$ is not very precise. The other parameters have fairly precise posteriors. Systrom fixed all these parameters, except $\\sigma_R$, which he estimated by maximum likelihood to be 0.25. In these posteriors, a 95% credible region for $\\sigma_R$ contains his estimate. The posterior of $\\rho$ is not far from his imposed value of $1$, although $1$ is out of the 95% credible region. A 95% posterior region for $\\gamma$ contains Systrom\u2019s calibrated value of $1/7$. It is worth noting that the estimate of $\\sigma_k$ is large compared to $\\sigma_r$. This will cause new observations of $\\Delta \\log k$ will have a small effect on the posterior mean of $R$. Given values of the parameters, we can compute state and time specific posterior estimates of $R_{s,t}$. states = unique(sdf.state) s = findfirst(states.==\"New York\") figr = plotpostr(dates[s],dlogk[s],post, ones(length(dlogk[s]),1), [1]) display(plot(figr, ylim=(-1,10))) This figure shows the posterior distribution of $R_{s,t}$ in New York. The black line is the posterior mean. The dark grey region is the average (over model parameters) of a 90% credible region conditional on the model parameters. This is comparable to what Systrom (and many others) report, and ignores uncertainty in the model parameters. The light grey region is a 90% credile region taking into account parameter uncertainty. The points and error bars are mean and 90% credible regions for \\Delta \\log k_{t}/\\gamma + 1 = R_{t} + \\epsilon_t/\\gamma Posteriors for additional states \u00b6 states_to_plot = [\"New Jersey\",\"Massachusetts\",\"California\", \"Georgia\",\"Illinois\",\"Michigan\", \"Ohio\",\"Wisconsin\",\"Washington\"] S = length(states_to_plot) figs = fill(plot(), 9*(S \u00f7 9 + 1)) for (i,st) in enumerate(states_to_plot) s = findfirst(states.==st) figr = plotpostr(dates[s],dlogk[s],post, ones(length(dlogk[s]),1),[1]) l = @layout [a{.1h}; grid(1,1)] figs[i] = plot(plot(annotation=(0.5,0.5, st), framestyle = :none), plot(figr, ylim=(-1,10)), layout=l) if ((i % 9) ==0 || ( i==length(states_to_plot))) display(plot(figs[(i-8):i]..., layout=(3,3), reuse=false)) end end We can see that the posteriors vary very little from state to state. The model picks up a general downward trend in $\\Delta \\log k$ through the slightly less than 1 estimate of $\\rho$. This drives the posteriors of $R_{s,t}$ in every state to decrease over time. Since $\\sigma_k >> \\sigma_R$, the actual realizations of $\\Delta \\log k$ do not affect the state-specific posteriors very much. Note I also tried fixing $\\rho=1$. This gives similar results in terms of $\\sigma_k >> \\sigma_R$, and gives a posterior for $R_{s,t}$ that is approximately constant over time. Bettencourt, Ruy M., Lu\u00eds M. A. AND Ribeiro. 2008. \u201cReal Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases.\u201d PLOS ONE 3 (5): 1\u20139. https://doi.org/10.1371/journal.pone.0002185 . Kurtz, Vince, and Hai Lin. 2019. \u201cKalman Filtering with Gaussian Processes Measurement Noise.\u201d","title":"Systrom Approach"},{"location":"Rt/#model","text":"Following Kevin Systrom , we adapt the approach of (Bettencourt 2008 ) to compute real-time rolling estimates of pandemic parameters. (Bettencourt 2008 ) begin from a SIR model, \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I \\\\ \\dot{R} & = \\gamma I \\end{align*} To this we add the possibility that not all cases are known. Cases get get detected at rate $I$, so cumulative confirmed cases, $C$, evolves as \\dot{C} = \\tau I Question Should we add other states to this model? If yes, how? I think using death and hospitalization numbers in estimation makes sense. The number of new confirmed cases from time $t$ to $t+\\delta$ is then: We will allow for the testing rate, $\\tau$, and infection rate, $\\beta$, to vary over time. k_t \\equiv \\frac{C(t+\\delta) - C(t)}{\\delta} = \\int_t^{t+\\delta} \\tau(s) I(s) ds \\approx \\tau(t) I(t) As in (Bettencourt 2008 ), \\begin{align*} I(t) = & I(t-\\delta) \\int_{t-\\delta}^{t} e^{\\frac{S(s)}{N} \\beta(s) - \\gamma} ds \\\\ \\approx & I(t-\\delta) e^{\\delta \\left( \\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma \\right)} \\end{align*} Note The reproductive number is: $R_t \\equiv \\frac{S(t)}{N}\\frac{\\beta(t)}{\\gamma}$. Substituting the expression for $I_t$ into $k_t$, we have \\begin{align*} k_t \\approx & \\tau(t) I(t-\\delta) e^{\\delta \\left( \\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma\\right)} \\\\ \\approx & k_{t-\\delta} \\frac{\\tau(t)}{\\tau(t-\\delta)} e^{\\delta \\left(\\frac{S(t-\\delta)}{N} \\beta(t-\\delta) - \\gamma \\right)} \\end{align*}","title":"Model"},{"location":"Rt/#data","text":"We use data as on US states on Covid cases, deaths, policies, and other variables. The data combines information on Daily case counts and deaths from NYTimes Daily Hospitalizations, recoveries, and testing from the Covid Tracking Project Covid related policy changes from Raifman et al Movements from Google Mobility Reports Hourly workers from Hoembase","title":"Data"},{"location":"Rt/#statistical-model","text":"The above theoretical model gives a deterministic relationship between $k_t$ and $k_{t-1}$ given the parameters. To bring it to data we must add stochasticity.","title":"Statistical Model"},{"location":"Rt/#systroms-approach","text":"First we describe what Systrom does. He assumes that $R_{0} \\sim Gamma(4,1)$. Then for $t=1, \u2026, T$, he computes $P(R_t|k_{t}, k_{t-1}, \u2026 ,k_0)$ iteratively using Bayes\u2019 rules. Specifically, he assumes k_t | R_t, k_{t-1}, ... \\sim Poisson(k_{t-1} e^{\\gamma(R_t - 1)}) and that $R_t$ follows a random walk, so the prior of $R_t | R_{t-1}$ is R_t | R_{t-1} \\sim N(R_{t-1}, \\sigma^2) so that P(R_t|k_{t}, k_{t-1}, ... ,k_0) = \\frac{P(k_t | R_t, k_{t-1}) P(R_t | R_{t-1}) P(R_{t-1} | k_{t-1}, ...)} {P(k_t)} Note that this computes posteriors of $R_t$ given current and past cases. Future cases are also informative of $R_t$, and you could instead compute $P(R_t | k_0, k_1, \u2026, k_T)$. The notebook makes some mentions of Gaussian processes. There\u2019s likely some way to recast the random walk assumption as a Gaussian process prior (the kernel would be $\\kappa(t,t\u2019) = \\min{t,t\u2019} \\sigma^2$), but that seems to me like an unusual way to describe it.","title":"Systrom\u2019s approach"},{"location":"Rt/#code","text":"Let\u2019s see how Systrom\u2019s method works. First the load data. using Pkg try using CovidData catch pkg\"registry add https://github.com/schrimpf/julia-registry.git\" Pkg.develop(\"CovidData\") Pkg.develop(\"CovidRt\") end using DataFrames, Plots, StatsPlots, CovidRt, CovidData Plots.pyplot() df = CovidData.statedata() df = filter(x->x.fips<60, df) # focus on 10 states with most cases as of April 1, 2020 sdf = select(df[df[!,:date].==Dates.Date(\"2020-04-01\"),:], Symbol(\"cases.nyt\"), :state) |> x->sort(x,Symbol(\"cases.nyt\"), rev=true) states=sdf[1:10,:state] sdf = select(filter(r->r[:state] \u2208 states, df), Symbol(\"cases.nyt\"), :state, :date) sdf = sort(sdf, [:state, :date]) sdf[!,:newcases] = by(sdf, :state, newcases = Symbol(\"cases.nyt\") => x->(vcat(missing, diff(x))))[!,:newcases] figs = [] for gdf in groupby(sdf, :state) f = @df gdf plot(:date, :newcases, legend=:none, linewidth=2, title=unique(gdf.state)[1]) global figs = vcat(figs,f) end display(plot(figs[1:9]..., layout=(3,3))) From this we can see that new cases are very noisy. This is especially problematic when cases jump from near 0 to very high values, such as in Illinois. The median value of and variance of new cases, $k_t$, are both $k_{t-1} e^{\\gamma(R_t - 1)}$. Only huge changes in $R_t$ can rationalize huge jumps in new cases. Let\u2019s compute posteriors for each state. using Interpolations, Distributions function rtpost(cases, \u03b3, \u03c3, prior0, casepdf) (rgrid, postgrid, ll) = rtpostgrid(cases)(\u03b3, \u03c3, prior0, casepdf) w = rgrid[2] - rgrid[1] T = length(cases) p = [LinearInterpolation(rgrid, postgrid[:,t]) for t in 1:T] coverage = 0.9 cr = zeros(T,2) mu = vec(rgrid' * postgrid*w) for t in 1:T l = findfirst(cumsum(postgrid[:,t].*w).>(1-coverage)/2) h = findlast(cumsum(postgrid[:,t].*w).<(1-(1-coverage)/2)) if !(l === nothing || h === nothing) cr[t,:] = [rgrid[l], rgrid[h]] end end return(p, mu, cr) end function rtpostgrid(cases) # We'll compute the posterior on these values of R_t rlo = 0 rhi = 8 steps = 500 rgrid = range(rlo, rhi, length=steps) \u0394grid = range(0.05, 0.95, length=10) w = rgrid[2] - rgrid[1] dr = rgrid .- rgrid' fn=function(\u03b3, \u03c3, prior0, casepdf) prr = pdf.(Normal(0,\u03c3), dr) # P(r_{t+1} | r_t) for i in 1:size(prr,1) prr[i, : ] ./= sum(prr[i,:].*w) end postgrid = Matrix{typeof(\u03c3)}(undef,length(rgrid), length(cases)) # P(R_t | k_t, k_{t-1},...) like = similar(postgrid, length(cases)) for t in 1:length(cases) if (t==1) postgrid[:,t] .= prior0.(rgrid) else if (cases[t-1]===missing || cases[t]===missing) pkr = 1 # P(k_t | R_t) else \u03bb = max(cases[t-1],1).* exp.(\u03b3 .* (rgrid .- 1)) #r = \u03bb*nbp/(1-nbp) #pkr = pdf.(NegativeBinomial.(r,nbp), cases[t]) pkr = casepdf.(\u03bb, cases[t]) if (all(pkr.==0)) @warn \"all pkr=0\" #@show t, cases[t], cases[t-1] pkr .= 1 end end postgrid[:,t] = pkr.*(prr*postgrid[:,t-1]) like[t] = sum(postgrid[:,t].*w) postgrid[:,t] ./= max(like[t], 1e-15) end end ll = try sum(log.(like)) catch -710*length(like) end return((rgrid, postgrid, ll)) end return(fn) end for \u03c3 in [0.1, 0.25, 1] \u03b3 =1/7 nbp = 0.01 figs = [] for gdf in groupby(sdf, :state) p, m, cr = rtpost(gdf.newcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(Poisson(\u03bb),x)) f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Poisson & \u03c3=$\u03c3\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l)) end In these results, what is happening is that when new cases fluctuate too much, the likelihood is identically 0, causing the posterior calculation to break down. Increasing the variance of changes in $R_t$, widens the posterior confidence intervals, but does not solve the problem of vanishing likelihoods. One thing that can \u201csolve\u201d the problem is choosing a distribution of $k_t | \\lambda, k_{t-1}$ with higher variance. The negative binomial with parameters $\\lambda p/(1-p)$ and $p$ has mean $\\lambda$ and variance $\\lambda/p$. \u03b3 =1/7 \u03c3 = 0.25 Plots.closeall() for \u03c3 in [0.1, 0.25, 0.5] for nbp in [0.5, 0.1, 0.01] figs = [] for gdf in groupby(sdf, :state) p, m, cr = rtpost(gdf.newcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(NegativeBinomial(\u03bb*nbp/(1-nbp), nbp),x)); f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Negative binomial, p=$nbp, & \u03c3=$\u03c3\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l, reuse=false)) end end What Systrom did was smooth the new cases before using the Poisson distribution. He used a window width of $7$ and Gaussian weights with standard deviation $2$. \u03c3 = 0.25 Plots.closeall() for w in [3, 7, 11] for s in [0.5, 2, 4] \u03b3 =1/7 nbp = 0.01 figs = [] for gdf in groupby(sdf, :state) windowsize = w weights = pdf(Normal(0, s), -floor(windowsize/2):floor(windowsize/2)) weights = weights/sum(weights) smoothcases = smooth(gdf.newcases, w=weights) p, m, cr = rtpost(smoothcases, \u03b3, \u03c3, x->pdf(truncated(Gamma(4,1),0,8), x), (\u03bb,x)->pdf(Poisson(\u03bb),x)) f = plot(gdf.date, m, ribbon=(m-cr[:,1], cr[:,2] - m), title=unique(gdf.state)[1], legend=:none, ylabel=\"R\u209c\") f = hline!(f,[1.0]) figs = vcat(figs, f) end l = @layout [a{.1h};grid(1,1)] display(plot(plot(annotation=(0.5,0.5, \"Poisson & \u03c3=$\u03c3, s=$s, w=$w\"), framestyle = :none), plot(figs[1:9]..., layout=(3,3)), layout=l, reuse=false)) end end Here we see that we can get a variety of results depending on the smoothing used. All of these posteriors ignore the uncertainty in the choice of smoothing parameters (and procedure).","title":"Code"},{"location":"Rt/#an-alternative-approach","text":"Here we follow an approach similar in spirit to Systrom, with a few modifications and additions. The primary modification is that we alter the model of $k_t|k_{t-1}, R_t$ to allow measurement error in both $k_t$ and $k_{t-1}$. We make four additions. First, we utilize data on movement and business operations as auxillary noisy measures of $R_t$. Second, we allow state policies to shift the mean of $R_t$. Third, we combine data from all states to improve precision in each. Fourth, we incorporate testing numbers into the data. As above, we begin from the approximation k^*_{s,t} \\approx k^*_{s,t-1} \\frac{\\tau_{s,t}}{\\tau_{s,t-1}} e^{\\gamma(R_{st} - 1)}) where $k^*$ is the true, unobserved number of new cases. Taking logs and rearranging we have \\log(k^*_{s,t}) - \\log(k^*_{s,t-1}) = \\gamma(R_{s,t} - 1) + \\log\\left(\\frac{\\tau_{s,t}}{\\tau_{s,t-1}}\\right) Let $k_{s,t}$ be the noisy observed value of $k^*_{s,t}$, then \\log(k_{s,t}) - \\log(k_{s,t-1}) = \\gamma(R_{s,t} - 1) + \\log\\left(\\frac{\\tau_{s,t}}{\\tau_{s,t-1}}\\right) - \\epsilon_{s,t} + \\epsilon_{s,t-1} where \\log(k^*_{s,t}) = \\log(k_{s,t}) +\\epsilon_{s,t} and $\\epsilon_{s,t}$ is measurement error. With appropriate assumptions on $\\epsilon$, $\\tau$, $R$ and other observables, we can then use regression to estimate $R$. As a simple example, let\u2019s assume $R_{s,t} = R_{s,0} + \\alpha d_{s,t}$ where $d_{s,t}$ are indicators for NPI\u2019s being in place. That $\\tau_{s,t}$ is constant over time for each $s$ $E[\\epsilon_{s,t} - \\epsilon_{s,t-1}|d] = 0$ and $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ is uncorrelated over time (just to simplify; this is not a good assumption). ```{=html} ``` julia using GLM, RegressionTables pvars = [Symbol(\"Stay.at.home..shelter.in.place\"), Symbol(\"State.of.emergency\"), Symbol(\"Date.closed.K.12.schools\"), Symbol(\"Closed.gyms\"), Symbol(\"Closed.movie.theaters\"), Symbol(\"Closed.day.cares\"), Symbol(\"Date.banned.visitors.to.nursing.homes\"), Symbol(\"Closed.non.essential.businesses\"), Symbol(\"Closed.restaurants.except.take.out\")] sdf = copy(df) for p in pvars sdf[!,p] = by(sdf, :state, (:date, p) => x->(!ismissing(unique(x[p])[1]) .& (x.date .>= unique(x[p])[1]))).x1 end sdf = sort(sdf, [:state, :date]) sdf[!,:newcases] = by(sdf, :state, newcases = Symbol(\"cases.nyt\") => x->(vcat(missing, diff(x))))[!,:newcases] sdf[!,:dlogk] = by(sdf, :state, dlogk = :newcases => x->(vcat(missing, diff(log.(max.(x,0.1))))))[!,:dlogk] fmla = FormulaTerm(Term(:dlogk), Tuple(Term.(vcat(pvars,:state)))) reg = lm(fmla, sdf) regtable(reg, renderSettings=asciiOutput()) ----------------------------------------------- dlogk ------- (1) ----------------------------------------------- (Intercept) 0.175 (0.171) Stay.at.home..shelter.in.place 0.009 (0.060) State.of.emergency -0.093 (0.077) Date.closed.K.12.schools 0.047 (0.081) Closed.gyms -0.080 (0.120) Closed.movie.theaters 0.111 (0.127) Closed.day.cares 0.100 (0.056) Date.banned.visitors.to.nursing.homes -0.009 (0.047) Closed.non.essential.businesses -0.060 (0.069) Closed.restaurants.except.take.out -0.072 (0.107) state: Alaska 0.012 (0.227) state: Arizona -0.023 (0.198) state: Arkansas -0.037 (0.226) state: California -0.025 (0.197) state: Colorado -0.002 (0.219) state: Connecticut 0.032 (0.222) state: Delaware 0.024 (0.225) state: District of Columbia 0.052 (0.221) state: Florida 0.067 (0.216) state: Georgia 0.059 (0.217) state: Hawaii -0.025 (0.220) state: Idaho -0.036 (0.228) state: Illinois 0.007 (0.197) state: Indiana 0.089 (0.220) state: Iowa 0.014 (0.222) state: Kansas 0.073 (0.221) state: Kentucky 0.071 (0.220) state: Louisiana -0.001 (0.223) state: Maine -0.019 (0.227) state: Maryland 0.083 (0.219) state: Massachusetts 0.020 (0.200) state: Michigan 0.112 (0.224) state: Minnesota 0.073 (0.220) state: Mississippi 0.078 (0.226) state: Missouri 0.063 (0.221) state: Montana -0.089 (0.228) state: Nebraska 0.002 (0.207) state: Nevada 0.041 (0.219) state: New Hampshire -0.020 (0.217) state: New Jersey 0.048 (0.218) state: New Mexico 0.006 (0.226) state: New York 0.088 (0.216) state: North Carolina 0.057 (0.218) state: North Dakota 0.047 (0.226) state: Ohio 0.080 (0.224) state: Oklahoma 0.040 (0.221) state: Oregon -0.004 (0.215) state: Pennsylvania 0.028 (0.221) state: Rhode Island 0.036 (0.216) state: South Carolina 0.036 (0.221) state: South Dakota -0.035 (0.225) state: Tennessee 0.050 (0.220) state: Texas -0.018 (0.205) state: Utah 0.011 (0.212) state: Vermont 0.002 (0.222) state: Virginia 0.051 (0.222) state: Washington -0.022 (0.196) state: West Virginia -0.009 (0.234) state: Wisconsin -0.004 (0.201) state: Wyoming 0.015 (0.226) ----------------------------------------------- Estimator OLS ----------------------------------------------- N 2,876 R2 0.004 ----------------------------------------------- From this we get that if we assume $\\gamma = 1/7$, then the the baseline estimate of $R$ in Illinois is $7(0.046 + 0.034) + 1\\approx 1.56$ with a stay at home order, $R$ in Illinois becomes $7(0.046 + 0.035 - 0.147) + 1 \\approx 0.53$. Some of the policies have positive coefficient estimates, which is strange. This is likely due to assumption 1 being incorrect. There is likely an unobserved component of $R_{s,t}$ that is positively correlated with policy indicators.","title":"An alternative approach"},{"location":"Rt/#state-space-model","text":"A direct analog of Systrom\u2019s approach is to treat $R_{s,t}$ as an unobserved latent process. Specifically, we will assume that \\begin{align*} \\tilde{R}_{s,0} & \\sim N(\\alpha_0, \\sigma^2_{R,0}) \\\\ \\tilde{R}_{s,t} & = \\rho \\tilde{R}_{s,t} + u_{s,t} \\;,\\; u_{s,t} \\sim N(0, \\sigma^2_R) \\\\ R_{s,t} & = \\alpha + \\tilde{R}_{s,t} \\\\ \\Delta \\log(k)_{s,t} & = \\gamma (R_{s,t} - 1) + \\epsilon_{s,t} - \\epsilon_{s,t-1} \\;, \\; \\epsilon_{s,t} \\sim N(0, \\sigma^2_k) \\end{align*} Note that the Poisson assumption on the distribution of $k_{s,t}$ used by Systrom implies an extremely small $\\sigma^2_k$, since the variance of log Poisson($\\lambda$) distribution is $1/\\lambda$. If $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ weere independent over $t$, we could compute the likelihood and posteriors of $R_{s,t}$ through the standard Kalman filter. Of course, $\\epsilon_{s,t} - \\epsilon_{s,t-1}$ is not independent over time, so we must adjust the Kalman filter accordingly. We follow the approach of (Kurtz and Lin 2019 ) to make this adjustment. Question Is there a better reference? I\u2019m sure someone did this much earlier than 2019\u2026 We estimate the parameters using data from US states. We set time 0 as the first day in which a state had at least 10 cumulative cases. We then compute posteriors for the parameters by MCMC. We place the following priors on the parameters. using Distributions, TransformVariables, DynamicHMC, MCMCChains, Plots, StatsPlots, LogDensityProblems, Random, LinearAlgebra, JLD2 rlo=-1 rhi=1.1 priors = (\u03b3 = truncated(Normal(1/7,1/7), 1/28, 1/1), \u03c3R0 = truncated(Normal(1, 3), 0, Inf), \u03b10 = MvNormal([1], 3), \u03c3R = truncated(Normal(0.25,1),0,Inf), \u03c3k = truncated(Normal(0.1, 5), 0, Inf), \u03b1 = MvNormal([1], 3), \u03c1 = Uniform(rlo, rhi)) (\u03b3 = Truncated(Distributions.Normal{Float64}(\u03bc=0.14285714285714285, \u03c3=0.142 85714285714285), range=(0.03571428571428571, 1.0)), \u03c3R0 = Truncated(Distrib utions.Normal{Float64}(\u03bc=1.0, \u03c3=3.0), range=(0.0, Inf)), \u03b10 = IsoNormal( dim: 1 \u03bc: [1.0] \u03a3: [9.0] ) , \u03c3R = Truncated(Distributions.Normal{Float64}(\u03bc=0.25, \u03c3=1.0), range=(0.0, Inf)), \u03c3k = Truncated(Distributions.Normal{Float64}(\u03bc=0.1, \u03c3=5.0), range=(0 .0, Inf)), \u03b1 = IsoNormal( dim: 1 \u03bc: [1.0] \u03a3: [9.0] ) , \u03c1 = Distributions.Uniform{Float64}(a=-1.0, b=1.1)) The estimation is fast and the chain appears to mix well. reestimate=false sdf = sort(sdf, (:state, :date)); dlogk = [filter(x->((x.state==st) .& (x.cases .>=10)), sdf).dlogk for st in unique(sdf.state)]; dates = [filter(x->((x.state==st) .& (x.cases .>=10)), sdf).date for st in unique(sdf.state)]; mdl = RtModel(dlogk, priors) trans = as( (\u03b3 = as\u211d\u208a, \u03c3R0 = as\u211d\u208a, \u03b10 = as(Array, 1), \u03c3R = as\u211d\u208a, \u03c3k = as\u211d\u208a, \u03b1 = as(Array,1), \u03c1=as(Real, rlo, rhi)) ) P = TransformedLogDensity(trans, mdl) \u2207P = ADgradient(:ForwardDiff, P) p0 = (\u03b3 = 1/7, \u03c3R0=1.0, \u03b10=[4.0],\u03c3R=0.25, \u03c3k=2.0, \u03b1=[1], \u03c1=0.9) x0 = inverse(trans,p0) @time LogDensityProblems.logdensity_and_gradient(\u2207P, x0); 3.330265 seconds (6.58 M allocations: 327.353 MiB, 4.54% gc time) rng = MersenneTwister() steps = 100 warmup=default_warmup_stages(local_optimization=nothing, stepsize_search=nothing, init_steps=steps, middle_steps=steps, terminating_steps=2*steps, doubling_stages=3, M=Symmetric) x0 = x0 if (!isfile(\"rt1.jld2\") || reestimate) res = DynamicHMC.mcmc_keep_warmup(rng, \u2207P, 2000;initialization = (q = x0, \u03f5=0.1), reporter = LogProgressReport(nothing, 25, 15), warmup_stages =warmup); post = transform.(trans,res.inference.chain) @save \"rt1.jld2\" post end @load \"rt1.jld2\" post p = post[1] vals = hcat([vcat([length(v)==1 ? v : vec(v) for v in values(p)]...) for p in post]...)' vals = reshape(vals, size(vals)..., 1) names = vcat([length(p[s])==1 ? String(s) : String.(s).*\"[\".*string.(1:length(p[s])).*\"]\" for s in keys(p)]...) cc = MCMCChains.Chains(vals, names) display(cc) Object of type Chains, with data of type 2000\u00d77\u00d71 reshape(::LinearAlgebra.A djoint{Float64,Array{Float64,2}}, 2000, 7, 1) with eltype Float64 Iterations = 1:2000 Thinning interval = 1 Chains = 1 Samples per chain = 2000 parameters = \u03b3, \u03c3R0, \u03b10, \u03c3R, \u03c3k, \u03b1, \u03c1 2-element Array{MCMCChains.ChainDataFrame,1} Summary Statistics parameters mean std naive_se mcse ess r_hat \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u03b3 0.0919 0.0339 0.0008 0.0017 455.3275 1.0009 \u03c3R0 1.0223 0.6973 0.0156 0.0317 673.2799 0.9996 \u03b10 5.1918 1.7792 0.0398 0.0909 401.6285 1.0001 \u03c3R 0.0887 0.0735 0.0016 0.0027 821.3143 1.0004 \u03c3k 0.5507 0.0082 0.0002 0.0001 3009.0575 0.9997 \u03b1 0.4512 0.4386 0.0098 0.0249 307.9202 0.9996 \u03c1 0.9394 0.0122 0.0003 0.0005 787.5179 1.0002 Quantiles parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u2500\u2500\u2500\u2500\u2500\u2500 \u03b3 0.0451 0.0665 0.0849 0.1101 0.1721 \u03c3R0 0.0534 0.5141 0.8979 1.3925 2.7113 \u03b10 2.4360 3.8546 4.9722 6.3808 9.1091 \u03c3R 0.0028 0.0327 0.0722 0.1248 0.2819 \u03c3k 0.5345 0.5453 0.5505 0.5560 0.5677 \u03b1 -0.5931 0.2494 0.5305 0.7539 1.0493 \u03c1 0.9140 0.9315 0.9402 0.9481 0.9618 display(plot(cc)) The posterior for the initial distribution of $R_{0,s}$ is not very precise. The other parameters have fairly precise posteriors. Systrom fixed all these parameters, except $\\sigma_R$, which he estimated by maximum likelihood to be 0.25. In these posteriors, a 95% credible region for $\\sigma_R$ contains his estimate. The posterior of $\\rho$ is not far from his imposed value of $1$, although $1$ is out of the 95% credible region. A 95% posterior region for $\\gamma$ contains Systrom\u2019s calibrated value of $1/7$. It is worth noting that the estimate of $\\sigma_k$ is large compared to $\\sigma_r$. This will cause new observations of $\\Delta \\log k$ will have a small effect on the posterior mean of $R$. Given values of the parameters, we can compute state and time specific posterior estimates of $R_{s,t}$. states = unique(sdf.state) s = findfirst(states.==\"New York\") figr = plotpostr(dates[s],dlogk[s],post, ones(length(dlogk[s]),1), [1]) display(plot(figr, ylim=(-1,10))) This figure shows the posterior distribution of $R_{s,t}$ in New York. The black line is the posterior mean. The dark grey region is the average (over model parameters) of a 90% credible region conditional on the model parameters. This is comparable to what Systrom (and many others) report, and ignores uncertainty in the model parameters. The light grey region is a 90% credile region taking into account parameter uncertainty. The points and error bars are mean and 90% credible regions for \\Delta \\log k_{t}/\\gamma + 1 = R_{t} + \\epsilon_t/\\gamma","title":"State space model"},{"location":"Rt/#posteriors-for-additional-states","text":"states_to_plot = [\"New Jersey\",\"Massachusetts\",\"California\", \"Georgia\",\"Illinois\",\"Michigan\", \"Ohio\",\"Wisconsin\",\"Washington\"] S = length(states_to_plot) figs = fill(plot(), 9*(S \u00f7 9 + 1)) for (i,st) in enumerate(states_to_plot) s = findfirst(states.==st) figr = plotpostr(dates[s],dlogk[s],post, ones(length(dlogk[s]),1),[1]) l = @layout [a{.1h}; grid(1,1)] figs[i] = plot(plot(annotation=(0.5,0.5, st), framestyle = :none), plot(figr, ylim=(-1,10)), layout=l) if ((i % 9) ==0 || ( i==length(states_to_plot))) display(plot(figs[(i-8):i]..., layout=(3,3), reuse=false)) end end We can see that the posteriors vary very little from state to state. The model picks up a general downward trend in $\\Delta \\log k$ through the slightly less than 1 estimate of $\\rho$. This drives the posteriors of $R_{s,t}$ in every state to decrease over time. Since $\\sigma_k >> \\sigma_R$, the actual realizations of $\\Delta \\log k$ do not affect the state-specific posteriors very much. Note I also tried fixing $\\rho=1$. This gives similar results in terms of $\\sigma_k >> \\sigma_R$, and gives a posterior for $R_{s,t}$ that is approximately constant over time. Bettencourt, Ruy M., Lu\u00eds M. A. AND Ribeiro. 2008. \u201cReal Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases.\u201d PLOS ONE 3 (5): 1\u20139. https://doi.org/10.1371/journal.pone.0002185 . Kurtz, Vince, and Hai Lin. 2019. \u201cKalman Filtering with Gaussian Processes Measurement Noise.\u201d","title":"Posteriors for additional states"},{"location":"extensions/","text":"Another Derivation \u00b6 An alternative (and easier) way to derive the same estimator will be described here. This approach will easily generalize to more complicated models, but let\u2019s begin with the simplest SIR model with testing. \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I \\\\ \\dot{C} & = \\tau I \\\\ \\dot{\\mathcal{R}} & = \\gamma I \\end{align*} Then note that \\ddot{C} = \\dot{\\tau} I + \\tau \\dot{I} and \\begin{align*} \\frac{\\ddot{C}}{\\dot{C}} = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{\\dot{I}}{I} \\\\ \\frac{d}{dt} \\log(\\dot{C}) = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{S}{N}\\beta - \\gamma \\\\ = & \\frac{\\dot{\\tau}}{\\tau} + \\gamma(R_t - 1) \\end{align*} which is the equation we have been using for estimation. Incorporating death \u00b6 If we add deaths to the model, \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I - p I\\\\ \\dot{C} & = \\tau I \\\\ \\dot{\\mathcal{R}} & = \\gamma I \\\\ \\dot{D} & = p I \\end{align*} then, \\begin{align*} \\frac{\\ddot{C}}{\\dot{C}} = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{S}{N}\\beta - \\gamma - p \\\\ \\frac{\\ddot{D}}{\\dot{D}} = & \\frac{S}{N}\\beta - \\gamma - p \\\\ \\end{align*} Other observable states could similarly be added to the model. Time delays \u00b6 A drawback of the above approach is that it implies changes in $R_t$ show up in the derivatives of case and death numbers instantly. This is definitely not true. Instead consider a model where infections last $\\ell$ days. After $\\ell$ days, each infected person dies with probability $\\pi$ and recovers otherwise. Then we have \\begin{align*} \\dot{S}(t) & = -\\frac{S(t)}{N} \\beta I \\\\ \\dot{I}(t) & = \\frac{S(t)}{N} \\beta(t) I(t) - \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\\\ \\dot{C}(t) & = \\tau(t) I(t) \\\\ \\dot{\\mathcal{R}}(t) & = (1-\\pi) \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\\\ \\dot{D}(t) & = \\pi \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\end{align*} Rearranging gives \\frac{\\ddot{C}(t)}{\\dot{C}(t)} = \\frac{\\dot{\\tau}(t)}{\\tau(t)} + \\frac{S(t)}{N}\\beta(t) - \\frac{1}{\\pi} \\frac{\\dot{D}(t)}{\\dot{C}(t)} and \\dot{D}(t) = \\pi \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) \\frac{\\dot{C}(t-\\ell)}{\\tau(t-\\ell)} Note These last two equations also hold in the model without time delay by setting $\\ell=0$ and $\\pi = \\frac{p}{p+\\gamma}$ Note Random durations can be accomodated by replacing the shift by $\\ell$ with a convolution.","title":"Extensions"},{"location":"extensions/#another-derivation","text":"An alternative (and easier) way to derive the same estimator will be described here. This approach will easily generalize to more complicated models, but let\u2019s begin with the simplest SIR model with testing. \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I \\\\ \\dot{C} & = \\tau I \\\\ \\dot{\\mathcal{R}} & = \\gamma I \\end{align*} Then note that \\ddot{C} = \\dot{\\tau} I + \\tau \\dot{I} and \\begin{align*} \\frac{\\ddot{C}}{\\dot{C}} = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{\\dot{I}}{I} \\\\ \\frac{d}{dt} \\log(\\dot{C}) = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{S}{N}\\beta - \\gamma \\\\ = & \\frac{\\dot{\\tau}}{\\tau} + \\gamma(R_t - 1) \\end{align*} which is the equation we have been using for estimation.","title":"Another Derivation"},{"location":"extensions/#incorporating-death","text":"If we add deaths to the model, \\begin{align*} \\dot{S} & = -\\frac{S}{N} \\beta I \\\\ \\dot{I} & = \\frac{S}{N} \\beta I - \\gamma I - p I\\\\ \\dot{C} & = \\tau I \\\\ \\dot{\\mathcal{R}} & = \\gamma I \\\\ \\dot{D} & = p I \\end{align*} then, \\begin{align*} \\frac{\\ddot{C}}{\\dot{C}} = & \\frac{\\dot{\\tau}}{\\tau} + \\frac{S}{N}\\beta - \\gamma - p \\\\ \\frac{\\ddot{D}}{\\dot{D}} = & \\frac{S}{N}\\beta - \\gamma - p \\\\ \\end{align*} Other observable states could similarly be added to the model.","title":"Incorporating death"},{"location":"extensions/#time-delays","text":"A drawback of the above approach is that it implies changes in $R_t$ show up in the derivatives of case and death numbers instantly. This is definitely not true. Instead consider a model where infections last $\\ell$ days. After $\\ell$ days, each infected person dies with probability $\\pi$ and recovers otherwise. Then we have \\begin{align*} \\dot{S}(t) & = -\\frac{S(t)}{N} \\beta I \\\\ \\dot{I}(t) & = \\frac{S(t)}{N} \\beta(t) I(t) - \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\\\ \\dot{C}(t) & = \\tau(t) I(t) \\\\ \\dot{\\mathcal{R}}(t) & = (1-\\pi) \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\\\ \\dot{D}(t) & = \\pi \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) I(t-\\ell) \\end{align*} Rearranging gives \\frac{\\ddot{C}(t)}{\\dot{C}(t)} = \\frac{\\dot{\\tau}(t)}{\\tau(t)} + \\frac{S(t)}{N}\\beta(t) - \\frac{1}{\\pi} \\frac{\\dot{D}(t)}{\\dot{C}(t)} and \\dot{D}(t) = \\pi \\frac{S(t-\\ell)}{N} \\beta(t-\\ell) \\frac{\\dot{C}(t-\\ell)}{\\tau(t-\\ell)} Note These last two equations also hold in the model without time delay by setting $\\ell=0$ and $\\pi = \\frac{p}{p+\\gamma}$ Note Random durations can be accomodated by replacing the shift by $\\ell$ with a convolution.","title":"Time delays"},{"location":"license/","text":"The notes and results are licensed under a Creative Commons Attribution-ShareAlike 4.0 International License and were written by Paul Schrimpf. BibTeX citation. The license for the package source code is here.","title":"License"},{"location":"rt_longdiff/","text":"Longer Differences and Smoothing \u00b6 One way to reduce $\\sigma_k/\\sigma_R$ is to reduce noise in new cases by taking a longer difference or smoothing case counts in some other way. How does this affect the estimation and interpretation of $R_t$? As in the first section, we start with the approximate recursive relation C(t) - C(t-1) \\equiv \\Delta C(t) \\approx \\frac{\\tau(t)}{\\tau(t-1)} e^{\\gamma (R_t - 1)} \\Delta C(t-1) If we instead look at a longer difference, \\begin{align*} C(t) - C(t-L) = & \\sum_{i=0}^{L-1} \\Delta C_{t-i} \\\\ \\approx & \\sum_{i=0}^{L-1} \\frac{\\tau(t-i)}{\\tau(t-i-1)} e^{\\gamma (R_{t-i} - 1)} \\Delta C_{t-i-1} \\\\ = & \\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}} \\sum_{i=0}^{L-1}\\Delta C_{t-i-1} \\\\ = & \\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}} \\left( C(t-1) - C(t-1-L) \\right) \\end{align*} where $\\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}}$ is some intermediate value in between the minimum and maximum of the ${ \\frac{\\tau(t-i)}{\\tau(t-i-1)} e^{\\gamma (R_{t-i} - 1)} }_{i=0}^{L-1}$. If testing is constant over time, we can then obtain an interpretable $\\overline{R_{t,L}}$ by using $k_{t,L} =\\log(C(t)-C(t-L))$ and following the procedure above. If testing varies with time, it becomes hard to separate testing rate changes from $R_t$ after taking long differnces. Note The same analysis can be applied to other smoothing operations, i.e. using \\sum_{i=0}^L w_i \\Delta C_{t-i} in place of $C(t) - C(t-L)$. However, there\u2019s something strange about smoothing $C_t$, and then extracting a smoothed component of it using the Kalman filter. The inference afterwards is suspect; we would essentially be estimating a kernel regression of $C_t$ on time, and using the estimated regression as though it\u2019s known with certainty. When would long differences reduce variance? Well if $\\Delta C(t) = \\Delta C^\\ast(t) + \\epsilon_t$ with $\\epsilon_t$ indepenedent over time with mean $0$ and constant variance, then you would need $C^\\ast(t) - C^\\ast(t-L)$ to increase faster than linearly with $L$. This is true if $C^\\ast$ is growing exponentially. Alternatively, if $\\epsilon_t$ is not independent over time, but negatively correlated (as seems likely), then variance can decrease with $L$. For example, if $\\Delta C(t) = C^\\ast(t) - C^\\ast(t-\\delta)$ with $\\delta$ a random, independent increment with mean $1$, then variance will tend to decrease with $L$ regardless of $C^\\ast(t)$. Results \u00b6 # data prep using CovidData using CovidRt using TransformVariables, Parameters, Plots, StatsPlots, DataFrames, Dates, LinearAlgebra, Distributions, Random, LogDensityProblems, DynamicHMC, MCMCChains, JLD2, Latexify Plots.pyplot() df = CovidData.statedata(policies=:indicators, fillmissingmobility=true) pvars = [Symbol(\"Stay.at.home..shelter.in.place\"), #Symbol(\"State.of.emergency\"), Symbol(\"Date.closed.K.12.schools\"), Symbol(\"Closed.gyms\"), Symbol(\"Closed.movie.theaters\"), Symbol(\"Closed.day.cares\"), Symbol(\"Date.banned.visitors.to.nursing.homes\"), Symbol(\"Closed.non.essential.businesses\"), Symbol(\"Closed.restaurants.except.take.out\")] mvars = [:retail_and_recreation_percent_change_from_baseline, :grocery_and_pharmacy_percent_change_from_baseline, :parks_percent_change_from_baseline , :transit_stations_percent_change_from_baseline, :workplaces_percent_change_from_baseline, :residential_percent_change_from_baseline, :percentchangebusinesses] df[!,:logpopdens] = log.(df[!,Symbol(\"Population.density.per.square.miles\")]) df[!,:weekend] = dayofweek.(df[!,:date]) .>= 6 x0vars=[:constant, :logpopdens, Symbol(\"Percent.Unemployed..2018.\"), Symbol(\"Percent.living.under.the.federal.poverty.line..2018.\"), Symbol(\"Percent.at.risk.for.serious.illness.due.to.COVID\")] sdf = filter(x->x.fips<60, df) sdf = sort(sdf, (:state, :date)) sdf[!,mvars] ./= 100 sdf[!,:constant] .= 1 xvars = vcat(pvars,mvars, x0vars); Here, we will allow the initial and time varying mean of $R_{s,t}$ to depend on covariates. \\begin{align*} \\tilde{R}_{s,0} & \\sim N(X_{0,s} \\alpha_0, \\sigma^2_{R,0}) \\\\ \\tilde{R}_{s,t} & = \\rho \\tilde{R}_{s,t} + u_{s,t} \\;,\\; u_{s,t} \\sim N(0, \\sigma^2_R) \\\\ R_{s,t} & = X_{s,t} \\alpha + \\tilde{R}_{s,t} \\\\ \\Delta \\log(k)_{s,t} & = \\gamma (R_{s,t} - 1) + \\epsilon_{s,t} - \\epsilon_{s,t-1} \\;, \\; \\epsilon_{s,t} \\sim N(0, \\sigma^2_k) \\end{align*} We present estimates of $R_t$ with \\Delta C(t) = C(t) - C(t-L_1) and \\Delta log (\\Delta C(t)) = log (\\Delta C(t)) - log (\\Delta C(t - L_2)) for a variety of values of $L_1$ and $L_2$ reestimate=false rlo=-1 #1 - eps(Float64) rhi=1.2 #1+ eps(Float64) K = length(xvars) priors = (\u03b3 = truncated(Normal(1/7,1/7), 1/28, 1/1), \u03c3R0 = truncated(Normal(1, 3), 0, Inf), \u03b10 = MvNormal(zeros(length(x0vars)), sqrt(10)), #truncated(Normal(1, 3), 0, Inf), \u03c3R = truncated(Normal(0.25,1),0,Inf), \u03c3k = truncated(Normal(0.1, 5), 0, Inf), \u03c1 = Uniform(rlo, rhi), \u03b1 = MvNormal(zeros(K), sqrt(10)) ) states_to_plot = [\"New York\", \"New Jersey\",\"Massachusetts\",\"California\", \"Georgia\",\"Illinois\",\"Michigan\", \"Ohio\",\"Wisconsin\",\"Washington\"] warmup = default_warmup_stages(local_optimization=nothing, stepsize_search=nothing, init_steps=100, middle_steps=100, terminating_steps=2*100, doubling_stages=3, M=Symmetric) for L1 in [1, 3, 7] for L2 in [1, 3, 7] mdl = CovidRt.RtModel(sdf, Symbol(\"cases.nyt\"), xvars, x0vars, priors; L1=L1, L2=L2, time0=r->(r[Symbol(\"cases.nyt\")].>=5)) estfile = \"rt$(L1)_$(L2).jld2\" if !isfile(estfile) || reestimate post = CovidRt.mcmc(mdl; iterations=2000, warmup=warmup) @save estfile post end @load estfile post cc = CovidRt.MCMCChain(post, xvars, x0vars) println(\"## L\u2081 = $(L1), L\u2082 = $(L2)\") println() display(plot(cc)) println(latexify(DataFrame(describe(cc)[1]), env=:mdtable, latex=false, fmt=x->round(x, sigdigits=3))) println(latexify(DataFrame(describe(cc)[2]), env=:mdtable, latex=false, fmt=x->round(x, sigdigits=3))) states = mdl.id S = length(states_to_plot) figs = fill(plot(), S) for (i,st) in enumerate(states_to_plot) s = findfirst(states.==st) figr = CovidRt.plotpostr(mdl.t[s],mdl.dlogk[s],post, mdl.X[s], mdl.X0[s]) l = @layout [a{.1h}; grid(1,1)] figs[i] = plot(plot(annotation=(0.5,0.5, st), framestyle = :none), plot(figr, ylim=(-1,10)), layout=l) display(figs[i]) end end end L\u2081 = 1, L\u2082 = 1 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.238 0.0335 0.000749 0.000933 1130.0 1.0 \u03c3R0 8.32 1.3 0.029 0.0353 1320.0 1.0 \u03b10(constant) 0.0833 3.13 0.0699 0.0621 2950.0 1.0 \u03b10(logpopdens) -2.18 1.48 0.0332 0.0268 2420.0 1.0 \u03b10(Percent Unemployed 2018 ) -3.42 2.18 0.0488 0.0288 2900.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) 0.697 1.11 0.0248 0.019 2890.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.16 0.389 0.0087 0.00803 2510.0 1.0 \u03c3R 3.71 0.515 0.0115 0.0148 1170.0 1.0 \u03c3k 0.0262 0.0191 0.000428 0.000334 2370.0 1.0 \u03c1 -0.475 0.0166 0.000372 0.000307 3390.0 1.0 \u03b1(Stay at home shelter in place) -0.249 0.159 0.00355 0.00358 3040.0 1.0 \u03b1(Date closed K 12 schools) -0.0826 0.235 0.00526 0.00409 2540.0 1.0 \u03b1(Closed gyms) -0.208 0.309 0.0069 0.00685 2550.0 1.0 \u03b1(Closed movie theaters) 0.124 0.322 0.0072 0.00762 2770.0 1.0 \u03b1(Closed day cares) 0.0223 0.139 0.0031 0.00217 2380.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.0253 0.122 0.00272 0.00217 3140.0 1.0 \u03b1(Closed non essential businesses) -0.137 0.174 0.00389 0.00384 2810.0 1.0 \u03b1(Closed restaurants except take out) 0.116 0.276 0.00618 0.00662 3020.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.825 0.892 0.0199 0.0165 2530.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 0.864 0.68 0.0152 0.0141 2650.0 1.0 \u03b1(parks percent change from baseline) 0.238 0.191 0.00427 0.00338 3060.0 1.0 \u03b1(transit stations percent change from baseline) -0.0101 0.776 0.0174 0.0128 2870.0 1.0 \u03b1(workplaces percent change from baseline) -1.79 1.24 0.0277 0.0293 2990.0 1.0 \u03b1(residential percent change from baseline) 2.04 2.2 0.0492 0.0416 2990.0 1.0 \u03b1(percentchangebusinesses) 3.6 1.0 0.0225 0.0215 2050.0 1.0 \u03b1(constant) -0.203 0.735 0.0164 0.0187 2930.0 1.0 \u03b1(logpopdens) 0.075 0.0441 0.000986 0.000726 2990.0 0.999 \u03b1(Percent Unemployed 2018 ) 0.124 0.0833 0.00186 0.00124 2810.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.039 0.0365 0.000816 0.000413 3100.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0417 0.0208 0.000464 0.000489 2800.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.182 0.214 0.236 0.258 0.31 \u03c3R0 6.03 7.4 8.25 9.12 11.0 \u03b10(constant) -5.99 -2.06 0.12 2.33 6.06 \u03b10(logpopdens) -5.22 -3.12 -2.18 -1.15 0.743 \u03b10(Percent Unemployed 2018 ) -7.63 -4.89 -3.44 -1.99 0.895 \u03b10(Percent living under the federal poverty line 2018 ) -1.46 -0.0199 0.688 1.42 2.85 \u03b10(Percent at risk for serious illness due to COVID) -0.595 -0.0946 0.156 0.423 0.925 \u03c3R 2.79 3.36 3.67 4.04 4.78 \u03c3k 0.000933 0.0108 0.0225 0.0376 0.0722 \u03c1 -0.508 -0.487 -0.475 -0.464 -0.443 \u03b1(Stay at home shelter in place) -0.561 -0.351 -0.243 -0.141 0.0409 \u03b1(Date closed K 12 schools) -0.544 -0.233 -0.0781 0.0802 0.381 \u03b1(Closed gyms) -0.789 -0.414 -0.206 -0.0096 0.404 \u03b1(Closed movie theaters) -0.514 -0.083 0.114 0.342 0.783 \u03b1(Closed day cares) -0.255 -0.0684 0.0255 0.108 0.289 \u03b1(Date banned visitors to nursing homes) -0.271 -0.104 -0.0254 0.0546 0.211 \u03b1(Closed non essential businesses) -0.486 -0.246 -0.137 -0.0233 0.21 \u03b1(Closed restaurants except take out) -0.413 -0.0719 0.115 0.303 0.662 \u03b1(retail and recreation percent change from baseline) -2.62 -1.41 -0.817 -0.23 0.852 \u03b1(grocery and pharmacy percent change from baseline) -0.482 0.43 0.858 1.3 2.19 \u03b1(parks percent change from baseline) -0.139 0.106 0.235 0.366 0.625 \u03b1(transit stations percent change from baseline) -1.52 -0.532 -0.0456 0.52 1.56 \u03b1(workplaces percent change from baseline) -4.22 -2.62 -1.79 -0.966 0.585 \u03b1(residential percent change from baseline) -2.18 0.592 2.0 3.47 6.4 \u03b1(percentchangebusinesses) 1.71 2.9 3.57 4.27 5.65 \u03b1(constant) -1.72 -0.668 -0.198 0.306 1.19 \u03b1(logpopdens) -0.00984 0.0462 0.0738 0.104 0.165 \u03b1(Percent Unemployed 2018 ) -0.0336 0.0683 0.122 0.179 0.288 \u03b1(Percent living under the federal poverty line 2018 ) -0.113 -0.063 -0.0372 -0.015 0.0308 \u03b1(Percent at risk for serious illness due to COVID) 0.00243 0.0276 0.0408 0.0551 0.0831 L\u2081 = 1, L\u2082 = 3 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.115 0.0441 0.000986 0.00585 44.0 1.0 \u03c3R0 8.24 2.3 0.0515 0.226 67.4 1.0 \u03b10(constant) 0.246 3.1 0.0693 0.119 727.0 1.0 \u03b10(logpopdens) 0.979 2.0 0.0447 0.0765 944.0 1.0 \u03b10(Percent Unemployed 2018 ) 2.3 2.39 0.0535 0.093 1490.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.969 1.72 0.0384 0.0921 279.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.581 0.64 0.0143 0.0467 147.0 1.0 \u03c3R 0.758 0.652 0.0146 0.0326 314.0 1.0 \u03c3k 0.738 0.02 0.000447 0.00123 245.0 1.0 \u03c1 0.506 0.218 0.00487 0.03 38.2 1.0 \u03b1(Stay at home shelter in place) -2.44 1.3 0.029 0.213 42.3 1.02 \u03b1(Date closed K 12 schools) 0.227 0.921 0.0206 0.078 82.0 1.02 \u03b1(Closed gyms) -1.06 1.13 0.0252 0.0727 189.0 1.0 \u03b1(Closed movie theaters) 0.344 1.19 0.0265 0.0756 331.0 1.0 \u03b1(Closed day cares) -0.108 0.677 0.0151 0.0735 61.5 1.0 \u03b1(Date banned visitors to nursing homes) -0.312 0.585 0.0131 0.0715 52.1 1.0 \u03b1(Closed non essential businesses) -1.07 0.923 0.0206 0.0965 76.2 1.0 \u03b1(Closed restaurants except take out) 0.322 1.06 0.0237 0.0986 86.8 1.02 \u03b1(retail and recreation percent change from baseline) 0.345 2.12 0.0473 0.1 614.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.38 2.57 0.0575 0.332 65.7 1.02 \u03b1(parks percent change from baseline) 0.149 0.698 0.0156 0.0477 210.0 1.0 \u03b1(transit stations percent change from baseline) 2.47 2.33 0.0522 0.244 64.3 1.0 \u03b1(workplaces percent change from baseline) -4.29 2.23 0.0499 0.121 367.0 1.0 \u03b1(residential percent change from baseline) 4.09 2.94 0.0658 0.252 104.0 1.01 \u03b1(percentchangebusinesses) 6.13 2.18 0.0487 0.134 251.0 1.0 \u03b1(constant) 0.265 2.1 0.0471 0.151 242.0 1.0 \u03b1(logpopdens) 0.536 0.318 0.00711 0.0443 38.5 1.0 \u03b1(Percent Unemployed 2018 ) 0.759 0.492 0.011 0.0548 59.9 1.02 \u03b1(Percent living under the federal poverty line 2018 ) -0.245 0.177 0.00395 0.0165 90.9 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0938 0.1 0.00224 0.0113 55.4 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0366 0.0915 0.119 0.141 0.203 \u03c3R0 2.38 6.98 8.34 9.67 12.5 \u03b10(constant) -5.53 -1.85 0.107 2.36 6.65 \u03b10(logpopdens) -2.65 -0.354 0.904 2.2 5.35 \u03b10(Percent Unemployed 2018 ) -2.4 0.69 2.4 3.84 6.99 \u03b10(Percent living under the federal poverty line 2018 ) -3.95 -2.09 -1.09 0.0518 2.87 \u03b10(Percent at risk for serious illness due to COVID) -0.743 0.18 0.589 1.02 1.77 \u03c3R 0.0328 0.262 0.57 1.09 2.45 \u03c3k 0.686 0.73 0.741 0.751 0.768 \u03c1 0.175 0.352 0.461 0.59 0.927 \u03b1(Stay at home shelter in place) -6.69 -2.83 -2.11 -1.6 -0.89 \u03b1(Date closed K 12 schools) -1.29 -0.36 0.143 0.705 2.42 \u03b1(Closed gyms) -3.29 -1.74 -1.08 -0.406 1.29 \u03b1(Closed movie theaters) -2.02 -0.341 0.347 1.07 2.66 \u03b1(Closed day cares) -1.85 -0.419 -0.0543 0.309 1.04 \u03b1(Date banned visitors to nursing homes) -1.71 -0.572 -0.242 0.058 0.686 \u03b1(Closed non essential businesses) -3.66 -1.41 -0.929 -0.528 0.205 \u03b1(Closed restaurants except take out) -2.05 -0.254 0.352 0.957 2.38 \u03b1(retail and recreation percent change from baseline) -3.73 -1.05 0.341 1.69 4.52 \u03b1(grocery and pharmacy percent change from baseline) -5.83 0.152 1.53 2.91 6.1 \u03b1(parks percent change from baseline) -1.27 -0.252 0.134 0.579 1.52 \u03b1(transit stations percent change from baseline) -2.72 1.07 2.62 4.0 6.62 \u03b1(workplaces percent change from baseline) -8.74 -5.69 -4.29 -2.78 -0.0176 \u03b1(residential percent change from baseline) -1.14 1.99 4.17 6.15 9.99 \u03b1(percentchangebusinesses) 1.76 4.71 6.1 7.62 10.3 \u03b1(constant) -3.77 -1.06 0.153 1.49 5.02 \u03b1(logpopdens) 0.119 0.329 0.453 0.637 1.34 \u03b1(Percent Unemployed 2018 ) 0.0668 0.476 0.688 0.927 2.38 \u03b1(Percent living under the federal poverty line 2018 ) -0.579 -0.35 -0.252 -0.151 0.138 \u03b1(Percent at risk for serious illness due to COVID) -0.197 0.0563 0.105 0.153 0.245 L\u2081 = 1, L\u2082 = 7 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.104 0.0197 0.000441 0.000482 1040.0 1.0 \u03c3R0 8.77 1.55 0.0346 0.0345 1460.0 1.0 \u03b10(constant) 0.4 3.14 0.0703 0.087 2070.0 1.0 \u03b10(logpopdens) -0.365 1.2 0.0269 0.0285 1740.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.22 1.91 0.0426 0.0439 1750.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.673 0.894 0.02 0.023 1770.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.751 0.352 0.00788 0.00705 2010.0 1.0 \u03c3R 2.33 0.424 0.00949 0.00884 1220.0 1.0 \u03c3k 0.713 0.0128 0.000285 0.000314 2210.0 1.0 \u03c1 0.917 0.01 0.000224 0.000269 2360.0 1.0 \u03b1(Stay at home shelter in place) -3.51 1.21 0.0271 0.0291 1500.0 1.0 \u03b1(Date closed K 12 schools) 2.95 1.37 0.0307 0.0265 1950.0 1.0 \u03b1(Closed gyms) -0.535 1.75 0.0391 0.0351 2620.0 1.0 \u03b1(Closed movie theaters) -0.821 1.82 0.0406 0.0391 2320.0 1.0 \u03b1(Closed day cares) -0.28 1.17 0.0261 0.0297 1650.0 1.0 \u03b1(Date banned visitors to nursing homes) -1.49 1.05 0.0234 0.0228 2130.0 1.0 \u03b1(Closed non essential businesses) -2.18 1.23 0.0276 0.0341 1290.0 1.0 \u03b1(Closed restaurants except take out) 1.19 1.51 0.0337 0.0325 2440.0 1.0 \u03b1(retail and recreation percent change from baseline) -1.37 2.71 0.0605 0.0689 2180.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.06 2.38 0.0532 0.0553 1840.0 1.0 \u03b1(parks percent change from baseline) 0.533 0.9 0.0201 0.0173 2050.0 1.0 \u03b1(transit stations percent change from baseline) 0.492 2.58 0.0577 0.0488 2130.0 1.0 \u03b1(workplaces percent change from baseline) -0.802 2.39 0.0534 0.0459 2140.0 1.0 \u03b1(residential percent change from baseline) 1.76 3.05 0.0681 0.0543 1640.0 1.0 \u03b1(percentchangebusinesses) 1.85 2.47 0.0553 0.0453 2700.0 1.0 \u03b1(constant) 1.06 2.83 0.0633 0.0607 2070.0 1.0 \u03b1(logpopdens) 1.39 0.559 0.0125 0.0119 1520.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.133 0.901 0.0202 0.0223 2000.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.0657 0.385 0.0086 0.00641 2090.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) -0.0798 0.156 0.0035 0.00311 2300.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0728 0.09 0.101 0.115 0.152 \u03c3R0 5.96 7.7 8.66 9.77 11.9 \u03b10(constant) -5.77 -1.72 0.417 2.56 6.5 \u03b10(logpopdens) -2.74 -1.15 -0.384 0.429 1.98 \u03b10(Percent Unemployed 2018 ) -2.4 -0.112 1.18 2.52 4.95 \u03b10(Percent living under the federal poverty line 2018 ) -2.44 -1.26 -0.682 -0.0941 1.1 \u03b10(Percent at risk for serious illness due to COVID) 0.0927 0.52 0.734 0.966 1.49 \u03c3R 1.56 2.04 2.32 2.61 3.2 \u03c3k 0.688 0.704 0.713 0.722 0.738 \u03c1 0.896 0.91 0.917 0.924 0.936 \u03b1(Stay at home shelter in place) -5.96 -4.29 -3.44 -2.67 -1.25 \u03b1(Date closed K 12 schools) 0.372 2.05 2.88 3.83 5.83 \u03b1(Closed gyms) -3.96 -1.7 -0.519 0.673 2.86 \u03b1(Closed movie theaters) -4.44 -2.03 -0.808 0.451 2.59 \u03b1(Closed day cares) -2.52 -1.05 -0.266 0.504 2.04 \u03b1(Date banned visitors to nursing homes) -3.53 -2.19 -1.49 -0.751 0.506 \u03b1(Closed non essential businesses) -4.74 -2.95 -2.11 -1.34 0.0364 \u03b1(Closed restaurants except take out) -1.75 0.171 1.19 2.2 4.13 \u03b1(retail and recreation percent change from baseline) -6.68 -3.23 -1.31 0.473 3.79 \u03b1(grocery and pharmacy percent change from baseline) -5.76 -2.7 -1.04 0.52 3.64 \u03b1(parks percent change from baseline) -1.18 -0.0583 0.514 1.12 2.37 \u03b1(transit stations percent change from baseline) -4.63 -1.27 0.487 2.24 5.49 \u03b1(workplaces percent change from baseline) -5.33 -2.44 -0.855 0.775 3.88 \u03b1(residential percent change from baseline) -4.35 -0.17 1.79 3.76 7.77 \u03b1(percentchangebusinesses) -3.0 0.16 1.89 3.55 6.55 \u03b1(constant) -4.43 -0.815 1.04 2.99 6.55 \u03b1(logpopdens) 0.375 1.01 1.35 1.73 2.61 \u03b1(Percent Unemployed 2018 ) -1.69 -0.463 0.134 0.746 1.9 \u03b1(Percent living under the federal poverty line 2018 ) -0.84 -0.314 -0.054 0.184 0.682 \u03b1(Percent at risk for serious illness due to COVID) -0.396 -0.177 -0.0822 0.0231 0.229 L\u2081 = 3, L\u2082 = 1 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.0869 0.0176 0.000393 0.000766 437.0 1.0 \u03c3R0 11.2 1.92 0.0429 0.0762 562.0 1.0 \u03b10(constant) 0.16 3.18 0.0711 0.0827 1430.0 1.0 \u03b10(logpopdens) 0.65 3.06 0.0684 0.0759 1960.0 1.0 \u03b10(Percent Unemployed 2018 ) 0.534 3.07 0.0686 0.0697 1650.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) 0.85 2.92 0.0653 0.054 1440.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 2.52 1.66 0.037 0.0363 1210.0 1.0 \u03c3R 0.807 0.57 0.0128 0.0238 520.0 1.0 \u03c3k 0.23 0.0133 0.000298 0.000788 243.0 1.01 \u03c1 0.0669 0.0279 0.000623 0.000474 1260.0 1.0 \u03b1(Stay at home shelter in place) -0.915 0.321 0.00718 0.0112 1070.0 1.0 \u03b1(Date closed K 12 schools) 0.239 0.382 0.00854 0.00689 2330.0 1.0 \u03b1(Closed gyms) -0.373 0.483 0.0108 0.00748 2100.0 1.0 \u03b1(Closed movie theaters) -0.0107 0.497 0.0111 0.00797 1930.0 1.0 \u03b1(Closed day cares) -0.0175 0.235 0.00527 0.00646 1360.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.102 0.197 0.00441 0.00438 2300.0 1.0 \u03b1(Closed non essential businesses) -0.473 0.288 0.00644 0.00715 1480.0 1.0 \u03b1(Closed restaurants except take out) 0.0633 0.419 0.00938 0.00819 1970.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.279 1.3 0.0291 0.0314 1970.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.79 1.09 0.0243 0.0278 1810.0 1.0 \u03b1(parks percent change from baseline) -0.0168 0.273 0.0061 0.00616 2160.0 1.0 \u03b1(transit stations percent change from baseline) 1.92 1.15 0.0258 0.0348 1690.0 1.0 \u03b1(workplaces percent change from baseline) -1.11 1.62 0.0363 0.0469 1390.0 1.0 \u03b1(residential percent change from baseline) 6.07 2.57 0.0575 0.065 1790.0 1.0 \u03b1(percentchangebusinesses) 2.67 1.34 0.0299 0.0378 1200.0 1.0 \u03b1(constant) 0.00546 1.1 0.0246 0.0303 1430.0 1.0 \u03b1(logpopdens) 0.218 0.0815 0.00182 0.00217 1420.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.365 0.149 0.00333 0.00469 1330.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.156 0.0648 0.00145 0.00191 1340.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0701 0.0335 0.000748 0.000981 1240.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0585 0.0743 0.0847 0.0971 0.128 \u03c3R0 7.76 9.82 11.1 12.5 15.2 \u03b10(constant) -6.3 -1.97 0.152 2.3 6.12 \u03b10(logpopdens) -5.3 -1.47 0.647 2.7 6.83 \u03b10(Percent Unemployed 2018 ) -5.5 -1.51 0.592 2.6 6.32 \u03b10(Percent living under the federal poverty line 2018 ) -4.77 -1.13 0.809 2.9 6.55 \u03b10(Percent at risk for serious illness due to COVID) -0.315 1.37 2.41 3.49 6.15 \u03c3R 0.0395 0.347 0.701 1.15 2.17 \u03c3k 0.196 0.227 0.233 0.237 0.242 \u03c1 0.0231 0.0461 0.0638 0.0846 0.128 \u03b1(Stay at home shelter in place) -1.66 -1.11 -0.869 -0.685 -0.396 \u03b1(Date closed K 12 schools) -0.5 -0.0105 0.228 0.467 1.04 \u03b1(Closed gyms) -1.39 -0.671 -0.353 -0.0651 0.585 \u03b1(Closed movie theaters) -0.942 -0.333 -0.0111 0.298 0.971 \u03b1(Closed day cares) -0.469 -0.172 -0.0223 0.139 0.462 \u03b1(Date banned visitors to nursing homes) -0.511 -0.232 -0.0923 0.0347 0.271 \u03b1(Closed non essential businesses) -1.1 -0.644 -0.451 -0.271 0.0107 \u03b1(Closed restaurants except take out) -0.743 -0.201 0.0579 0.34 0.921 \u03b1(retail and recreation percent change from baseline) -2.88 -1.12 -0.274 0.562 2.34 \u03b1(grocery and pharmacy percent change from baseline) -0.234 1.06 1.74 2.46 4.03 \u03b1(parks percent change from baseline) -0.577 -0.186 -0.0108 0.161 0.494 \u03b1(transit stations percent change from baseline) -0.194 1.15 1.91 2.6 4.33 \u03b1(workplaces percent change from baseline) -4.64 -2.18 -1.07 0.00594 1.92 \u03b1(residential percent change from baseline) 1.01 4.3 6.1 7.84 11.1 \u03b1(percentchangebusinesses) 0.187 1.75 2.59 3.5 5.51 \u03b1(constant) -2.13 -0.683 0.024 0.712 2.15 \u03b1(logpopdens) 0.0712 0.161 0.212 0.27 0.389 \u03b1(Percent Unemployed 2018 ) 0.113 0.261 0.352 0.454 0.691 \u03b1(Percent living under the federal poverty line 2018 ) -0.297 -0.199 -0.149 -0.109 -0.0489 \u03b1(Percent at risk for serious illness due to COVID) 0.00903 0.0469 0.0681 0.0913 0.14 L\u2081 = 3, L\u2082 = 3 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.163 0.0254 0.000569 0.00059 976.0 1.0 \u03c3R0 9.23 1.44 0.0322 0.0238 1330.0 1.0 \u03b10(constant) 0.666 3.3 0.0737 0.0606 2930.0 1.0 \u03b10(logpopdens) -0.818 1.46 0.0326 0.0308 2820.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.94 2.05 0.0458 0.0458 2600.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -1.03 1.08 0.0241 0.0247 2490.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.402 0.389 0.00869 0.00776 2530.0 1.0 \u03c3R 3.25 0.488 0.0109 0.0104 1040.0 1.0 \u03c3k 0.0176 0.0134 0.000299 0.000358 2350.0 1.0 \u03c1 0.557 0.0159 0.000356 0.000227 2330.0 1.0 \u03b1(Stay at home shelter in place) -1.47 0.448 0.01 0.00838 2190.0 1.0 \u03b1(Date closed K 12 schools) -0.247 0.478 0.0107 0.00647 2660.0 1.0 \u03b1(Closed gyms) -0.738 0.704 0.0157 0.0105 2640.0 1.0 \u03b1(Closed movie theaters) -0.12 0.735 0.0164 0.0108 2540.0 1.0 \u03b1(Closed day cares) -0.259 0.381 0.00851 0.00694 3330.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.273 0.32 0.00715 0.00645 2400.0 1.0 \u03b1(Closed non essential businesses) -0.354 0.397 0.00887 0.00771 2350.0 1.0 \u03b1(Closed restaurants except take out) 0.253 0.547 0.0122 0.0101 2790.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.297 1.61 0.0359 0.0331 2750.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.69 1.28 0.0287 0.0365 2700.0 1.0 \u03b1(parks percent change from baseline) -0.178 0.303 0.00677 0.00696 2550.0 1.0 \u03b1(transit stations percent change from baseline) 2.46 1.46 0.0327 0.0293 2560.0 1.0 \u03b1(workplaces percent change from baseline) 1.25 1.52 0.0339 0.0296 2810.0 0.999 \u03b1(residential percent change from baseline) 4.02 2.49 0.0556 0.0498 3260.0 1.0 \u03b1(percentchangebusinesses) -0.116 1.16 0.026 0.0235 3050.0 1.0 \u03b1(constant) 1.5 1.61 0.0361 0.0292 2460.0 1.0 \u03b1(logpopdens) 0.329 0.138 0.00309 0.00234 2710.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.386 0.241 0.00539 0.00391 2950.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.188 0.101 0.00226 0.00146 2890.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0751 0.0501 0.00112 0.000779 2560.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.122 0.145 0.16 0.177 0.223 \u03c3R0 6.55 8.23 9.2 10.1 12.2 \u03b10(constant) -5.74 -1.56 0.664 2.9 7.24 \u03b10(logpopdens) -3.62 -1.85 -0.808 0.217 2.0 \u03b10(Percent Unemployed 2018 ) -1.99 0.565 1.95 3.34 5.9 \u03b10(Percent living under the federal poverty line 2018 ) -3.19 -1.73 -1.04 -0.309 1.11 \u03b10(Percent at risk for serious illness due to COVID) -0.359 0.152 0.394 0.671 1.21 \u03c3R 2.34 2.91 3.22 3.57 4.24 \u03c3k 0.000796 0.00682 0.0146 0.0248 0.05 \u03c1 0.525 0.547 0.557 0.568 0.588 \u03b1(Stay at home shelter in place) -2.38 -1.78 -1.44 -1.14 -0.684 \u03b1(Date closed K 12 schools) -1.18 -0.569 -0.228 0.0672 0.653 \u03b1(Closed gyms) -2.14 -1.19 -0.74 -0.27 0.646 \u03b1(Closed movie theaters) -1.59 -0.625 -0.116 0.383 1.3 \u03b1(Closed day cares) -1.01 -0.515 -0.248 0.000724 0.493 \u03b1(Date banned visitors to nursing homes) -0.961 -0.473 -0.257 -0.0551 0.329 \u03b1(Closed non essential businesses) -1.18 -0.592 -0.336 -0.0883 0.382 \u03b1(Closed restaurants except take out) -0.8 -0.113 0.239 0.617 1.36 \u03b1(retail and recreation percent change from baseline) -3.4 -1.38 -0.296 0.762 2.8 \u03b1(grocery and pharmacy percent change from baseline) -0.786 0.836 1.67 2.51 4.18 \u03b1(parks percent change from baseline) -0.811 -0.369 -0.171 0.0251 0.405 \u03b1(transit stations percent change from baseline) -0.239 1.44 2.46 3.47 5.39 \u03b1(workplaces percent change from baseline) -1.71 0.195 1.27 2.31 4.26 \u03b1(residential percent change from baseline) -0.874 2.31 4.07 5.72 8.8 \u03b1(percentchangebusinesses) -2.4 -0.896 -0.0914 0.667 2.19 \u03b1(constant) -1.72 0.437 1.5 2.58 4.61 \u03b1(logpopdens) 0.0734 0.237 0.32 0.414 0.626 \u03b1(Percent Unemployed 2018 ) -0.0826 0.223 0.383 0.544 0.866 \u03b1(Percent living under the federal poverty line 2018 ) -0.396 -0.252 -0.187 -0.12 -0.000843 \u03b1(Percent at risk for serious illness due to COVID) -0.0203 0.0411 0.0736 0.108 0.177 L\u2081 = 3, L\u2082 = 7 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.167 0.0275 0.000615 0.00109 783.0 1.0 \u03c3R0 8.23 1.4 0.0314 0.0541 795.0 1.0 \u03b10(constant) 1.23 3.06 0.0683 0.0557 3170.0 1.0 \u03b10(logpopdens) -1.22 1.01 0.0227 0.0273 1870.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.5 1.65 0.0369 0.0311 2110.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.252 0.732 0.0164 0.0126 2300.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.331 0.26 0.00582 0.00623 2130.0 1.0 \u03c3R 3.06 0.49 0.011 0.0205 785.0 1.0 \u03c3k 0.0403 0.0251 0.000562 0.000468 1680.0 1.0 \u03c1 0.832 0.0126 0.000282 0.000364 2060.0 1.0 \u03b1(Stay at home shelter in place) -1.34 0.604 0.0135 0.0141 1990.0 1.0 \u03b1(Date closed K 12 schools) 0.736 0.574 0.0128 0.00813 2840.0 1.0 \u03b1(Closed gyms) -1.47 0.963 0.0215 0.0234 2540.0 1.0 \u03b1(Closed movie theaters) 0.346 0.993 0.0222 0.0231 2540.0 1.0 \u03b1(Closed day cares) -0.226 0.644 0.0144 0.0177 2210.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.471 0.581 0.013 0.0125 2140.0 1.0 \u03b1(Closed non essential businesses) -0.0801 0.608 0.0136 0.0106 3040.0 1.0 \u03b1(Closed restaurants except take out) 1.1 0.702 0.0157 0.0167 2690.0 1.0 \u03b1(retail and recreation percent change from baseline) 6.21 1.82 0.0408 0.0347 2320.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.22 1.51 0.0338 0.0232 2920.0 1.0 \u03b1(parks percent change from baseline) -0.643 0.325 0.00728 0.0054 2660.0 1.0 \u03b1(transit stations percent change from baseline) 0.246 1.76 0.0393 0.0313 2440.0 1.0 \u03b1(workplaces percent change from baseline) 1.25 1.6 0.0357 0.0291 2440.0 1.0 \u03b1(residential percent change from baseline) -0.192 2.42 0.0542 0.0537 3030.0 1.0 \u03b1(percentchangebusinesses) 0.165 1.09 0.0244 0.0314 2400.0 1.0 \u03b1(constant) 3.23 2.54 0.0567 0.0335 3500.0 1.0 \u03b1(logpopdens) 0.947 0.333 0.00746 0.00574 2220.0 1.0 \u03b1(Percent Unemployed 2018 ) -0.165 0.534 0.0119 0.0135 2280.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.112 0.239 0.00534 0.00487 2250.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0546 0.0998 0.00223 0.00124 2620.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.124 0.147 0.164 0.184 0.229 \u03c3R0 5.7 7.26 8.13 9.16 11.2 \u03b10(constant) -4.45 -0.916 1.25 3.27 7.17 \u03b10(logpopdens) -3.22 -1.9 -1.21 -0.521 0.723 \u03b10(Percent Unemployed 2018 ) -1.76 0.403 1.48 2.6 4.79 \u03b10(Percent living under the federal poverty line 2018 ) -1.74 -0.742 -0.238 0.223 1.23 \u03b10(Percent at risk for serious illness due to COVID) -0.147 0.152 0.318 0.491 0.868 \u03c3R 2.18 2.72 3.04 3.39 4.01 \u03c3k 0.00208 0.0195 0.038 0.0595 0.0902 \u03c1 0.807 0.823 0.832 0.84 0.856 \u03b1(Stay at home shelter in place) -2.58 -1.73 -1.31 -0.916 -0.189 \u03b1(Date closed K 12 schools) -0.402 0.369 0.721 1.11 1.94 \u03b1(Closed gyms) -3.47 -2.08 -1.46 -0.813 0.384 \u03b1(Closed movie theaters) -1.59 -0.332 0.343 1.02 2.31 \u03b1(Closed day cares) -1.52 -0.659 -0.205 0.21 0.98 \u03b1(Date banned visitors to nursing homes) -1.62 -0.846 -0.479 -0.0873 0.651 \u03b1(Closed non essential businesses) -1.28 -0.482 -0.0713 0.317 1.07 \u03b1(Closed restaurants except take out) -0.203 0.61 1.07 1.57 2.49 \u03b1(retail and recreation percent change from baseline) 2.73 4.96 6.18 7.36 9.92 \u03b1(grocery and pharmacy percent change from baseline) -4.02 -2.25 -1.24 -0.218 1.83 \u03b1(parks percent change from baseline) -1.33 -0.855 -0.633 -0.417 -0.0281 \u03b1(transit stations percent change from baseline) -3.3 -0.931 0.249 1.39 3.68 \u03b1(workplaces percent change from baseline) -1.77 0.165 1.22 2.34 4.42 \u03b1(residential percent change from baseline) -4.87 -1.84 -0.19 1.43 4.55 \u03b1(percentchangebusinesses) -2.03 -0.558 0.166 0.856 2.27 \u03b1(constant) -1.91 1.51 3.24 4.94 8.12 \u03b1(logpopdens) 0.344 0.717 0.935 1.16 1.63 \u03b1(Percent Unemployed 2018 ) -1.19 -0.524 -0.17 0.177 0.906 \u03b1(Percent living under the federal poverty line 2018 ) -0.609 -0.261 -0.105 0.0448 0.343 \u03b1(Percent at risk for serious illness due to COVID) -0.14 -0.0102 0.0541 0.117 0.255 L\u2081 = 7, L\u2082 = 1 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.0728 0.0167 0.000373 0.000824 414.0 1.0 \u03c3R0 8.25 1.72 0.0385 0.0688 572.0 1.0 \u03b10(constant) 0.0816 3.16 0.0706 0.0533 2840.0 1.0 \u03b10(logpopdens) 0.369 3.11 0.0695 0.069 2470.0 1.0 \u03b10(Percent Unemployed 2018 ) 0.298 3.1 0.0693 0.0618 2330.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.159 2.56 0.0573 0.0641 2300.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 1.0 1.11 0.0248 0.0263 2150.0 1.0 \u03c3R 2.37 0.529 0.0118 0.0176 730.0 1.01 \u03c3k 0.0698 0.033 0.000738 0.00142 649.0 1.0 \u03c1 0.0933 0.0332 0.000743 0.00118 896.0 1.0 \u03b1(Stay at home shelter in place) -1.17 0.348 0.00778 0.0114 740.0 1.0 \u03b1(Date closed K 12 schools) 0.00193 0.29 0.00648 0.00666 2220.0 1.0 \u03b1(Closed gyms) -0.34 0.38 0.0085 0.0102 2160.0 1.0 \u03b1(Closed movie theaters) 0.0138 0.394 0.00882 0.00846 2060.0 1.0 \u03b1(Closed day cares) -0.192 0.176 0.00393 0.00417 1560.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.139 0.156 0.00348 0.00237 2030.0 1.0 \u03b1(Closed non essential businesses) -0.6 0.243 0.00543 0.00817 852.0 1.0 \u03b1(Closed restaurants except take out) 0.119 0.336 0.00751 0.00705 2590.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.382 1.07 0.0239 0.0208 1970.0 0.999 \u03b1(grocery and pharmacy percent change from baseline) 0.285 0.823 0.0184 0.0158 2390.0 1.0 \u03b1(parks percent change from baseline) 0.0582 0.214 0.00478 0.00499 2200.0 1.0 \u03b1(transit stations percent change from baseline) 2.49 1.0 0.0224 0.0249 1470.0 1.0 \u03b1(workplaces percent change from baseline) 1.49 1.4 0.0313 0.0309 1750.0 1.0 \u03b1(residential percent change from baseline) 8.64 2.33 0.0521 0.0481 2580.0 1.0 \u03b1(percentchangebusinesses) 1.2 1.07 0.0239 0.0221 1760.0 1.0 \u03b1(constant) 0.334 0.896 0.02 0.0169 2340.0 1.0 \u03b1(logpopdens) 0.281 0.0875 0.00196 0.00275 738.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.396 0.134 0.003 0.00394 1110.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.155 0.0583 0.0013 0.00168 1050.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0706 0.03 0.000671 0.000877 1250.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0472 0.0608 0.0703 0.0823 0.111 \u03c3R0 5.21 6.99 8.14 9.37 11.9 \u03b10(constant) -5.83 -2.14 0.00505 2.23 6.23 \u03b10(logpopdens) -5.74 -1.71 0.355 2.48 6.48 \u03b10(Percent Unemployed 2018 ) -5.75 -1.83 0.21 2.43 6.08 \u03b10(Percent living under the federal poverty line 2018 ) -5.33 -1.84 -0.0771 1.58 4.86 \u03b10(Percent at risk for serious illness due to COVID) -1.0 0.23 0.947 1.69 3.34 \u03c3R 1.42 1.99 2.35 2.71 3.51 \u03c3k 0.00518 0.0445 0.0748 0.0954 0.122 \u03c1 0.0362 0.0702 0.0895 0.112 0.171 \u03b1(Stay at home shelter in place) -1.96 -1.37 -1.12 -0.929 -0.609 \u03b1(Date closed K 12 schools) -0.579 -0.186 0.00493 0.191 0.569 \u03b1(Closed gyms) -1.13 -0.583 -0.32 -0.0895 0.377 \u03b1(Closed movie theaters) -0.779 -0.249 0.00973 0.27 0.806 \u03b1(Closed day cares) -0.56 -0.298 -0.181 -0.0718 0.132 \u03b1(Date banned visitors to nursing homes) -0.47 -0.232 -0.13 -0.0412 0.159 \u03b1(Closed non essential businesses) -1.12 -0.759 -0.572 -0.423 -0.18 \u03b1(Closed restaurants except take out) -0.559 -0.0996 0.115 0.342 0.783 \u03b1(retail and recreation percent change from baseline) -2.55 -1.09 -0.372 0.337 1.68 \u03b1(grocery and pharmacy percent change from baseline) -1.33 -0.252 0.272 0.815 1.92 \u03b1(parks percent change from baseline) -0.367 -0.0798 0.0616 0.195 0.474 \u03b1(transit stations percent change from baseline) 0.782 1.79 2.41 3.13 4.61 \u03b1(workplaces percent change from baseline) -1.44 0.597 1.57 2.43 4.02 \u03b1(residential percent change from baseline) 3.95 7.11 8.65 10.2 13.2 \u03b1(percentchangebusinesses) -0.73 0.464 1.14 1.86 3.51 \u03b1(constant) -1.54 -0.239 0.357 0.918 2.06 \u03b1(logpopdens) 0.14 0.218 0.273 0.333 0.482 \u03b1(Percent Unemployed 2018 ) 0.167 0.303 0.382 0.48 0.691 \u03b1(Percent living under the federal poverty line 2018 ) -0.283 -0.194 -0.151 -0.113 -0.0581 \u03b1(Percent at risk for serious illness due to COVID) 0.019 0.0487 0.0681 0.0891 0.136 L\u2081 = 7, L\u2082 = 3 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.0881 0.014 0.000313 0.000405 907.0 1.0 \u03c3R0 8.6 1.39 0.0311 0.0358 1080.0 0.999 \u03b10(constant) 0.218 3.07 0.0687 0.0833 1840.0 1.0 \u03b10(logpopdens) -0.244 1.11 0.0247 0.0246 1790.0 1.0 \u03b10(Percent Unemployed 2018 ) -0.363 1.73 0.0387 0.0415 1870.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.348 0.826 0.0185 0.018 2000.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.41 0.289 0.00647 0.0083 2090.0 1.0 \u03c3R 3.19 0.498 0.0111 0.0138 912.0 1.0 \u03c3k 0.0123 0.00903 0.000202 0.000211 1440.0 1.0 \u03c1 0.738 0.0139 0.000311 0.000351 2830.0 1.0 \u03b1(Stay at home shelter in place) -1.79 0.572 0.0128 0.00956 1620.0 1.0 \u03b1(Date closed K 12 schools) -0.0229 0.563 0.0126 0.0138 2210.0 1.0 \u03b1(Closed gyms) -0.911 0.876 0.0196 0.0132 2170.0 1.0 \u03b1(Closed movie theaters) -0.0547 0.929 0.0208 0.0121 2060.0 1.0 \u03b1(Closed day cares) -0.452 0.562 0.0126 0.0133 1480.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.573 0.479 0.0107 0.0128 1660.0 1.0 \u03b1(Closed non essential businesses) -0.382 0.522 0.0117 0.0115 2050.0 1.0 \u03b1(Closed restaurants except take out) 0.671 0.714 0.016 0.0134 2060.0 1.0 \u03b1(retail and recreation percent change from baseline) 0.585 1.78 0.0397 0.0395 1690.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.79 1.44 0.0321 0.0395 1950.0 1.0 \u03b1(parks percent change from baseline) -0.101 0.323 0.00723 0.00647 2030.0 1.0 \u03b1(transit stations percent change from baseline) 3.92 1.74 0.039 0.0417 2060.0 1.0 \u03b1(workplaces percent change from baseline) 1.95 1.61 0.036 0.043 1790.0 1.0 \u03b1(residential percent change from baseline) 2.85 2.5 0.0558 0.0606 2020.0 1.0 \u03b1(percentchangebusinesses) 0.364 1.13 0.0253 0.0256 2220.0 1.0 \u03b1(constant) 2.52 2.2 0.0493 0.0455 1830.0 1.0 \u03b1(logpopdens) 0.736 0.241 0.00539 0.00499 2000.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.409 0.402 0.00898 0.00841 2030.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.207 0.167 0.00372 0.00353 1960.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0677 0.0729 0.00163 0.00173 1830.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0642 0.0779 0.0868 0.0966 0.12 \u03c3R0 6.03 7.65 8.49 9.52 11.4 \u03b10(constant) -5.77 -1.83 0.261 2.36 6.02 \u03b10(logpopdens) -2.37 -0.998 -0.266 0.509 2.01 \u03b10(Percent Unemployed 2018 ) -3.79 -1.54 -0.397 0.845 2.87 \u03b10(Percent living under the federal poverty line 2018 ) -1.95 -0.895 -0.345 0.17 1.33 \u03b10(Percent at risk for serious illness due to COVID) -0.15 0.212 0.399 0.6 0.996 \u03c3R 2.28 2.84 3.15 3.51 4.27 \u03c3k 0.000396 0.00502 0.0106 0.018 0.0333 \u03c1 0.71 0.728 0.737 0.747 0.765 \u03b1(Stay at home shelter in place) -3.0 -2.16 -1.75 -1.4 -0.761 \u03b1(Date closed K 12 schools) -1.16 -0.385 -0.0234 0.36 1.03 \u03b1(Closed gyms) -2.62 -1.51 -0.902 -0.3 0.763 \u03b1(Closed movie theaters) -1.93 -0.631 -0.0647 0.567 1.78 \u03b1(Closed day cares) -1.61 -0.799 -0.451 -0.0914 0.636 \u03b1(Date banned visitors to nursing homes) -1.55 -0.873 -0.554 -0.249 0.298 \u03b1(Closed non essential businesses) -1.43 -0.721 -0.381 -0.0303 0.688 \u03b1(Closed restaurants except take out) -0.692 0.191 0.669 1.13 2.11 \u03b1(retail and recreation percent change from baseline) -2.87 -0.591 0.561 1.8 4.02 \u03b1(grocery and pharmacy percent change from baseline) -4.59 -2.76 -1.79 -0.808 0.961 \u03b1(parks percent change from baseline) -0.77 -0.315 -0.0967 0.119 0.519 \u03b1(transit stations percent change from baseline) 0.535 2.75 3.91 5.1 7.31 \u03b1(workplaces percent change from baseline) -1.35 0.872 1.95 3.07 4.95 \u03b1(residential percent change from baseline) -2.15 1.2 2.82 4.51 7.77 \u03b1(percentchangebusinesses) -1.87 -0.391 0.373 1.11 2.57 \u03b1(constant) -1.7 1.05 2.48 3.97 6.86 \u03b1(logpopdens) 0.306 0.569 0.717 0.889 1.24 \u03b1(Percent Unemployed 2018 ) -0.351 0.143 0.402 0.662 1.22 \u03b1(Percent living under the federal poverty line 2018 ) -0.536 -0.312 -0.205 -0.0934 0.118 \u03b1(Percent at risk for serious illness due to COVID) -0.0734 0.0181 0.0673 0.116 0.216 L\u2081 = 7, L\u2082 = 7 \u00b6 parameters mean std naive_se mcse ess r_hat \u03b3 0.127 0.0233 0.000522 0.000711 734.0 1.0 \u03c3R0 7.85 1.46 0.0326 0.0386 987.0 1.0 \u03b10(constant) 0.736 2.97 0.0665 0.0491 2800.0 1.0 \u03b10(logpopdens) 0.00781 0.98 0.0219 0.0229 2420.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.04 1.54 0.0345 0.0391 2400.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.772 0.705 0.0158 0.0155 2560.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.53 0.263 0.00587 0.00469 2770.0 1.0 \u03c3R 2.51 0.449 0.01 0.0131 835.0 1.0 \u03c3k 0.081 0.0101 0.000225 0.000244 2140.0 1.0 \u03c1 0.911 0.00845 0.000189 0.000225 2100.0 1.0 \u03b1(Stay at home shelter in place) -0.556 0.551 0.0123 0.00821 2940.0 1.0 \u03b1(Date closed K 12 schools) 0.955 0.687 0.0154 0.0127 3000.0 1.0 \u03b1(Closed gyms) 0.52 0.987 0.0221 0.0189 3030.0 1.0 \u03b1(Closed movie theaters) -0.228 1.03 0.023 0.0198 3480.0 1.0 \u03b1(Closed day cares) 0.123 0.747 0.0167 0.0119 3120.0 1.0 \u03b1(Date banned visitors to nursing homes) -1.32 0.759 0.017 0.0154 2510.0 1.0 \u03b1(Closed non essential businesses) -0.0478 0.61 0.0136 0.0103 3100.0 1.0 \u03b1(Closed restaurants except take out) 0.728 0.786 0.0176 0.0158 3140.0 1.0 \u03b1(retail and recreation percent change from baseline) 5.62 1.91 0.0427 0.0287 2940.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -5.41 1.57 0.0352 0.0263 2940.0 1.0 \u03b1(parks percent change from baseline) -0.21 0.306 0.00684 0.00687 2940.0 1.0 \u03b1(transit stations percent change from baseline) 3.05 1.81 0.0405 0.0321 3030.0 1.0 \u03b1(workplaces percent change from baseline) 1.69 1.57 0.0352 0.0286 3020.0 1.0 \u03b1(residential percent change from baseline) 0.79 2.33 0.0521 0.0453 2790.0 1.0 \u03b1(percentchangebusinesses) 0.313 0.961 0.0215 0.0206 2790.0 1.0 \u03b1(constant) 3.28 2.87 0.0641 0.0608 3010.0 1.0 \u03b1(logpopdens) 1.33 0.522 0.0117 0.0104 2820.0 1.0 \u03b1(Percent Unemployed 2018 ) -0.517 0.822 0.0184 0.0172 2730.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) 0.0748 0.338 0.00757 0.0058 2960.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) -0.0575 0.133 0.00297 0.00266 2780.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0899 0.11 0.124 0.141 0.179 \u03c3R0 5.3 6.81 7.78 8.79 10.9 \u03b10(constant) -5.04 -1.3 0.747 2.83 6.46 \u03b10(logpopdens) -1.92 -0.639 0.0109 0.627 1.98 \u03b10(Percent Unemployed 2018 ) -1.86 -0.00685 0.992 2.09 4.08 \u03b10(Percent living under the federal poverty line 2018 ) -2.23 -1.25 -0.749 -0.279 0.612 \u03b10(Percent at risk for serious illness due to COVID) 0.0392 0.357 0.517 0.693 1.07 \u03c3R 1.73 2.2 2.48 2.82 3.46 \u03c3k 0.0596 0.0748 0.0817 0.088 0.0988 \u03c1 0.894 0.905 0.911 0.916 0.927 \u03b1(Stay at home shelter in place) -1.69 -0.899 -0.549 -0.18 0.47 \u03b1(Date closed K 12 schools) -0.308 0.489 0.945 1.4 2.35 \u03b1(Closed gyms) -1.41 -0.112 0.513 1.12 2.55 \u03b1(Closed movie theaters) -2.31 -0.902 -0.223 0.455 1.84 \u03b1(Closed day cares) -1.3 -0.36 0.113 0.61 1.63 \u03b1(Date banned visitors to nursing homes) -2.86 -1.78 -1.3 -0.809 0.0802 \u03b1(Closed non essential businesses) -1.32 -0.452 -0.0337 0.36 1.13 \u03b1(Closed restaurants except take out) -0.727 0.192 0.726 1.25 2.33 \u03b1(retail and recreation percent change from baseline) 1.94 4.38 5.61 6.86 9.43 \u03b1(grocery and pharmacy percent change from baseline) -8.57 -6.45 -5.39 -4.34 -2.48 \u03b1(parks percent change from baseline) -0.842 -0.409 -0.205 -0.014 0.393 \u03b1(transit stations percent change from baseline) -0.483 1.83 3.08 4.25 6.6 \u03b1(workplaces percent change from baseline) -1.52 0.7 1.71 2.71 4.73 \u03b1(residential percent change from baseline) -3.76 -0.743 0.777 2.38 5.33 \u03b1(percentchangebusinesses) -1.51 -0.332 0.258 0.952 2.28 \u03b1(constant) -2.27 1.36 3.4 5.27 8.53 \u03b1(logpopdens) 0.411 0.965 1.3 1.67 2.45 \u03b1(Percent Unemployed 2018 ) -2.06 -1.07 -0.529 0.0268 1.05 \u03b1(Percent living under the federal poverty line 2018 ) -0.589 -0.141 0.0723 0.294 0.768 \u03b1(Percent at risk for serious illness due to COVID) -0.318 -0.144 -0.0618 0.0276 0.206","title":"Long-differening"},{"location":"rt_longdiff/#longer-differences-and-smoothing","text":"One way to reduce $\\sigma_k/\\sigma_R$ is to reduce noise in new cases by taking a longer difference or smoothing case counts in some other way. How does this affect the estimation and interpretation of $R_t$? As in the first section, we start with the approximate recursive relation C(t) - C(t-1) \\equiv \\Delta C(t) \\approx \\frac{\\tau(t)}{\\tau(t-1)} e^{\\gamma (R_t - 1)} \\Delta C(t-1) If we instead look at a longer difference, \\begin{align*} C(t) - C(t-L) = & \\sum_{i=0}^{L-1} \\Delta C_{t-i} \\\\ \\approx & \\sum_{i=0}^{L-1} \\frac{\\tau(t-i)}{\\tau(t-i-1)} e^{\\gamma (R_{t-i} - 1)} \\Delta C_{t-i-1} \\\\ = & \\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}} \\sum_{i=0}^{L-1}\\Delta C_{t-i-1} \\\\ = & \\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}} \\left( C(t-1) - C(t-1-L) \\right) \\end{align*} where $\\overline {T_{t,L} e^{\\gamma(R_{t,L} - 1)}}$ is some intermediate value in between the minimum and maximum of the ${ \\frac{\\tau(t-i)}{\\tau(t-i-1)} e^{\\gamma (R_{t-i} - 1)} }_{i=0}^{L-1}$. If testing is constant over time, we can then obtain an interpretable $\\overline{R_{t,L}}$ by using $k_{t,L} =\\log(C(t)-C(t-L))$ and following the procedure above. If testing varies with time, it becomes hard to separate testing rate changes from $R_t$ after taking long differnces. Note The same analysis can be applied to other smoothing operations, i.e. using \\sum_{i=0}^L w_i \\Delta C_{t-i} in place of $C(t) - C(t-L)$. However, there\u2019s something strange about smoothing $C_t$, and then extracting a smoothed component of it using the Kalman filter. The inference afterwards is suspect; we would essentially be estimating a kernel regression of $C_t$ on time, and using the estimated regression as though it\u2019s known with certainty. When would long differences reduce variance? Well if $\\Delta C(t) = \\Delta C^\\ast(t) + \\epsilon_t$ with $\\epsilon_t$ indepenedent over time with mean $0$ and constant variance, then you would need $C^\\ast(t) - C^\\ast(t-L)$ to increase faster than linearly with $L$. This is true if $C^\\ast$ is growing exponentially. Alternatively, if $\\epsilon_t$ is not independent over time, but negatively correlated (as seems likely), then variance can decrease with $L$. For example, if $\\Delta C(t) = C^\\ast(t) - C^\\ast(t-\\delta)$ with $\\delta$ a random, independent increment with mean $1$, then variance will tend to decrease with $L$ regardless of $C^\\ast(t)$.","title":"Longer Differences and Smoothing"},{"location":"rt_longdiff/#results","text":"# data prep using CovidData using CovidRt using TransformVariables, Parameters, Plots, StatsPlots, DataFrames, Dates, LinearAlgebra, Distributions, Random, LogDensityProblems, DynamicHMC, MCMCChains, JLD2, Latexify Plots.pyplot() df = CovidData.statedata(policies=:indicators, fillmissingmobility=true) pvars = [Symbol(\"Stay.at.home..shelter.in.place\"), #Symbol(\"State.of.emergency\"), Symbol(\"Date.closed.K.12.schools\"), Symbol(\"Closed.gyms\"), Symbol(\"Closed.movie.theaters\"), Symbol(\"Closed.day.cares\"), Symbol(\"Date.banned.visitors.to.nursing.homes\"), Symbol(\"Closed.non.essential.businesses\"), Symbol(\"Closed.restaurants.except.take.out\")] mvars = [:retail_and_recreation_percent_change_from_baseline, :grocery_and_pharmacy_percent_change_from_baseline, :parks_percent_change_from_baseline , :transit_stations_percent_change_from_baseline, :workplaces_percent_change_from_baseline, :residential_percent_change_from_baseline, :percentchangebusinesses] df[!,:logpopdens] = log.(df[!,Symbol(\"Population.density.per.square.miles\")]) df[!,:weekend] = dayofweek.(df[!,:date]) .>= 6 x0vars=[:constant, :logpopdens, Symbol(\"Percent.Unemployed..2018.\"), Symbol(\"Percent.living.under.the.federal.poverty.line..2018.\"), Symbol(\"Percent.at.risk.for.serious.illness.due.to.COVID\")] sdf = filter(x->x.fips<60, df) sdf = sort(sdf, (:state, :date)) sdf[!,mvars] ./= 100 sdf[!,:constant] .= 1 xvars = vcat(pvars,mvars, x0vars); Here, we will allow the initial and time varying mean of $R_{s,t}$ to depend on covariates. \\begin{align*} \\tilde{R}_{s,0} & \\sim N(X_{0,s} \\alpha_0, \\sigma^2_{R,0}) \\\\ \\tilde{R}_{s,t} & = \\rho \\tilde{R}_{s,t} + u_{s,t} \\;,\\; u_{s,t} \\sim N(0, \\sigma^2_R) \\\\ R_{s,t} & = X_{s,t} \\alpha + \\tilde{R}_{s,t} \\\\ \\Delta \\log(k)_{s,t} & = \\gamma (R_{s,t} - 1) + \\epsilon_{s,t} - \\epsilon_{s,t-1} \\;, \\; \\epsilon_{s,t} \\sim N(0, \\sigma^2_k) \\end{align*} We present estimates of $R_t$ with \\Delta C(t) = C(t) - C(t-L_1) and \\Delta log (\\Delta C(t)) = log (\\Delta C(t)) - log (\\Delta C(t - L_2)) for a variety of values of $L_1$ and $L_2$ reestimate=false rlo=-1 #1 - eps(Float64) rhi=1.2 #1+ eps(Float64) K = length(xvars) priors = (\u03b3 = truncated(Normal(1/7,1/7), 1/28, 1/1), \u03c3R0 = truncated(Normal(1, 3), 0, Inf), \u03b10 = MvNormal(zeros(length(x0vars)), sqrt(10)), #truncated(Normal(1, 3), 0, Inf), \u03c3R = truncated(Normal(0.25,1),0,Inf), \u03c3k = truncated(Normal(0.1, 5), 0, Inf), \u03c1 = Uniform(rlo, rhi), \u03b1 = MvNormal(zeros(K), sqrt(10)) ) states_to_plot = [\"New York\", \"New Jersey\",\"Massachusetts\",\"California\", \"Georgia\",\"Illinois\",\"Michigan\", \"Ohio\",\"Wisconsin\",\"Washington\"] warmup = default_warmup_stages(local_optimization=nothing, stepsize_search=nothing, init_steps=100, middle_steps=100, terminating_steps=2*100, doubling_stages=3, M=Symmetric) for L1 in [1, 3, 7] for L2 in [1, 3, 7] mdl = CovidRt.RtModel(sdf, Symbol(\"cases.nyt\"), xvars, x0vars, priors; L1=L1, L2=L2, time0=r->(r[Symbol(\"cases.nyt\")].>=5)) estfile = \"rt$(L1)_$(L2).jld2\" if !isfile(estfile) || reestimate post = CovidRt.mcmc(mdl; iterations=2000, warmup=warmup) @save estfile post end @load estfile post cc = CovidRt.MCMCChain(post, xvars, x0vars) println(\"## L\u2081 = $(L1), L\u2082 = $(L2)\") println() display(plot(cc)) println(latexify(DataFrame(describe(cc)[1]), env=:mdtable, latex=false, fmt=x->round(x, sigdigits=3))) println(latexify(DataFrame(describe(cc)[2]), env=:mdtable, latex=false, fmt=x->round(x, sigdigits=3))) states = mdl.id S = length(states_to_plot) figs = fill(plot(), S) for (i,st) in enumerate(states_to_plot) s = findfirst(states.==st) figr = CovidRt.plotpostr(mdl.t[s],mdl.dlogk[s],post, mdl.X[s], mdl.X0[s]) l = @layout [a{.1h}; grid(1,1)] figs[i] = plot(plot(annotation=(0.5,0.5, st), framestyle = :none), plot(figr, ylim=(-1,10)), layout=l) display(figs[i]) end end end","title":"Results"},{"location":"rt_longdiff/#l1-1-l2-1","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.238 0.0335 0.000749 0.000933 1130.0 1.0 \u03c3R0 8.32 1.3 0.029 0.0353 1320.0 1.0 \u03b10(constant) 0.0833 3.13 0.0699 0.0621 2950.0 1.0 \u03b10(logpopdens) -2.18 1.48 0.0332 0.0268 2420.0 1.0 \u03b10(Percent Unemployed 2018 ) -3.42 2.18 0.0488 0.0288 2900.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) 0.697 1.11 0.0248 0.019 2890.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.16 0.389 0.0087 0.00803 2510.0 1.0 \u03c3R 3.71 0.515 0.0115 0.0148 1170.0 1.0 \u03c3k 0.0262 0.0191 0.000428 0.000334 2370.0 1.0 \u03c1 -0.475 0.0166 0.000372 0.000307 3390.0 1.0 \u03b1(Stay at home shelter in place) -0.249 0.159 0.00355 0.00358 3040.0 1.0 \u03b1(Date closed K 12 schools) -0.0826 0.235 0.00526 0.00409 2540.0 1.0 \u03b1(Closed gyms) -0.208 0.309 0.0069 0.00685 2550.0 1.0 \u03b1(Closed movie theaters) 0.124 0.322 0.0072 0.00762 2770.0 1.0 \u03b1(Closed day cares) 0.0223 0.139 0.0031 0.00217 2380.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.0253 0.122 0.00272 0.00217 3140.0 1.0 \u03b1(Closed non essential businesses) -0.137 0.174 0.00389 0.00384 2810.0 1.0 \u03b1(Closed restaurants except take out) 0.116 0.276 0.00618 0.00662 3020.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.825 0.892 0.0199 0.0165 2530.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 0.864 0.68 0.0152 0.0141 2650.0 1.0 \u03b1(parks percent change from baseline) 0.238 0.191 0.00427 0.00338 3060.0 1.0 \u03b1(transit stations percent change from baseline) -0.0101 0.776 0.0174 0.0128 2870.0 1.0 \u03b1(workplaces percent change from baseline) -1.79 1.24 0.0277 0.0293 2990.0 1.0 \u03b1(residential percent change from baseline) 2.04 2.2 0.0492 0.0416 2990.0 1.0 \u03b1(percentchangebusinesses) 3.6 1.0 0.0225 0.0215 2050.0 1.0 \u03b1(constant) -0.203 0.735 0.0164 0.0187 2930.0 1.0 \u03b1(logpopdens) 0.075 0.0441 0.000986 0.000726 2990.0 0.999 \u03b1(Percent Unemployed 2018 ) 0.124 0.0833 0.00186 0.00124 2810.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.039 0.0365 0.000816 0.000413 3100.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0417 0.0208 0.000464 0.000489 2800.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.182 0.214 0.236 0.258 0.31 \u03c3R0 6.03 7.4 8.25 9.12 11.0 \u03b10(constant) -5.99 -2.06 0.12 2.33 6.06 \u03b10(logpopdens) -5.22 -3.12 -2.18 -1.15 0.743 \u03b10(Percent Unemployed 2018 ) -7.63 -4.89 -3.44 -1.99 0.895 \u03b10(Percent living under the federal poverty line 2018 ) -1.46 -0.0199 0.688 1.42 2.85 \u03b10(Percent at risk for serious illness due to COVID) -0.595 -0.0946 0.156 0.423 0.925 \u03c3R 2.79 3.36 3.67 4.04 4.78 \u03c3k 0.000933 0.0108 0.0225 0.0376 0.0722 \u03c1 -0.508 -0.487 -0.475 -0.464 -0.443 \u03b1(Stay at home shelter in place) -0.561 -0.351 -0.243 -0.141 0.0409 \u03b1(Date closed K 12 schools) -0.544 -0.233 -0.0781 0.0802 0.381 \u03b1(Closed gyms) -0.789 -0.414 -0.206 -0.0096 0.404 \u03b1(Closed movie theaters) -0.514 -0.083 0.114 0.342 0.783 \u03b1(Closed day cares) -0.255 -0.0684 0.0255 0.108 0.289 \u03b1(Date banned visitors to nursing homes) -0.271 -0.104 -0.0254 0.0546 0.211 \u03b1(Closed non essential businesses) -0.486 -0.246 -0.137 -0.0233 0.21 \u03b1(Closed restaurants except take out) -0.413 -0.0719 0.115 0.303 0.662 \u03b1(retail and recreation percent change from baseline) -2.62 -1.41 -0.817 -0.23 0.852 \u03b1(grocery and pharmacy percent change from baseline) -0.482 0.43 0.858 1.3 2.19 \u03b1(parks percent change from baseline) -0.139 0.106 0.235 0.366 0.625 \u03b1(transit stations percent change from baseline) -1.52 -0.532 -0.0456 0.52 1.56 \u03b1(workplaces percent change from baseline) -4.22 -2.62 -1.79 -0.966 0.585 \u03b1(residential percent change from baseline) -2.18 0.592 2.0 3.47 6.4 \u03b1(percentchangebusinesses) 1.71 2.9 3.57 4.27 5.65 \u03b1(constant) -1.72 -0.668 -0.198 0.306 1.19 \u03b1(logpopdens) -0.00984 0.0462 0.0738 0.104 0.165 \u03b1(Percent Unemployed 2018 ) -0.0336 0.0683 0.122 0.179 0.288 \u03b1(Percent living under the federal poverty line 2018 ) -0.113 -0.063 -0.0372 -0.015 0.0308 \u03b1(Percent at risk for serious illness due to COVID) 0.00243 0.0276 0.0408 0.0551 0.0831","title":"L\u2081 = 1, L\u2082 = 1"},{"location":"rt_longdiff/#l1-1-l2-3","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.115 0.0441 0.000986 0.00585 44.0 1.0 \u03c3R0 8.24 2.3 0.0515 0.226 67.4 1.0 \u03b10(constant) 0.246 3.1 0.0693 0.119 727.0 1.0 \u03b10(logpopdens) 0.979 2.0 0.0447 0.0765 944.0 1.0 \u03b10(Percent Unemployed 2018 ) 2.3 2.39 0.0535 0.093 1490.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.969 1.72 0.0384 0.0921 279.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.581 0.64 0.0143 0.0467 147.0 1.0 \u03c3R 0.758 0.652 0.0146 0.0326 314.0 1.0 \u03c3k 0.738 0.02 0.000447 0.00123 245.0 1.0 \u03c1 0.506 0.218 0.00487 0.03 38.2 1.0 \u03b1(Stay at home shelter in place) -2.44 1.3 0.029 0.213 42.3 1.02 \u03b1(Date closed K 12 schools) 0.227 0.921 0.0206 0.078 82.0 1.02 \u03b1(Closed gyms) -1.06 1.13 0.0252 0.0727 189.0 1.0 \u03b1(Closed movie theaters) 0.344 1.19 0.0265 0.0756 331.0 1.0 \u03b1(Closed day cares) -0.108 0.677 0.0151 0.0735 61.5 1.0 \u03b1(Date banned visitors to nursing homes) -0.312 0.585 0.0131 0.0715 52.1 1.0 \u03b1(Closed non essential businesses) -1.07 0.923 0.0206 0.0965 76.2 1.0 \u03b1(Closed restaurants except take out) 0.322 1.06 0.0237 0.0986 86.8 1.02 \u03b1(retail and recreation percent change from baseline) 0.345 2.12 0.0473 0.1 614.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.38 2.57 0.0575 0.332 65.7 1.02 \u03b1(parks percent change from baseline) 0.149 0.698 0.0156 0.0477 210.0 1.0 \u03b1(transit stations percent change from baseline) 2.47 2.33 0.0522 0.244 64.3 1.0 \u03b1(workplaces percent change from baseline) -4.29 2.23 0.0499 0.121 367.0 1.0 \u03b1(residential percent change from baseline) 4.09 2.94 0.0658 0.252 104.0 1.01 \u03b1(percentchangebusinesses) 6.13 2.18 0.0487 0.134 251.0 1.0 \u03b1(constant) 0.265 2.1 0.0471 0.151 242.0 1.0 \u03b1(logpopdens) 0.536 0.318 0.00711 0.0443 38.5 1.0 \u03b1(Percent Unemployed 2018 ) 0.759 0.492 0.011 0.0548 59.9 1.02 \u03b1(Percent living under the federal poverty line 2018 ) -0.245 0.177 0.00395 0.0165 90.9 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0938 0.1 0.00224 0.0113 55.4 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0366 0.0915 0.119 0.141 0.203 \u03c3R0 2.38 6.98 8.34 9.67 12.5 \u03b10(constant) -5.53 -1.85 0.107 2.36 6.65 \u03b10(logpopdens) -2.65 -0.354 0.904 2.2 5.35 \u03b10(Percent Unemployed 2018 ) -2.4 0.69 2.4 3.84 6.99 \u03b10(Percent living under the federal poverty line 2018 ) -3.95 -2.09 -1.09 0.0518 2.87 \u03b10(Percent at risk for serious illness due to COVID) -0.743 0.18 0.589 1.02 1.77 \u03c3R 0.0328 0.262 0.57 1.09 2.45 \u03c3k 0.686 0.73 0.741 0.751 0.768 \u03c1 0.175 0.352 0.461 0.59 0.927 \u03b1(Stay at home shelter in place) -6.69 -2.83 -2.11 -1.6 -0.89 \u03b1(Date closed K 12 schools) -1.29 -0.36 0.143 0.705 2.42 \u03b1(Closed gyms) -3.29 -1.74 -1.08 -0.406 1.29 \u03b1(Closed movie theaters) -2.02 -0.341 0.347 1.07 2.66 \u03b1(Closed day cares) -1.85 -0.419 -0.0543 0.309 1.04 \u03b1(Date banned visitors to nursing homes) -1.71 -0.572 -0.242 0.058 0.686 \u03b1(Closed non essential businesses) -3.66 -1.41 -0.929 -0.528 0.205 \u03b1(Closed restaurants except take out) -2.05 -0.254 0.352 0.957 2.38 \u03b1(retail and recreation percent change from baseline) -3.73 -1.05 0.341 1.69 4.52 \u03b1(grocery and pharmacy percent change from baseline) -5.83 0.152 1.53 2.91 6.1 \u03b1(parks percent change from baseline) -1.27 -0.252 0.134 0.579 1.52 \u03b1(transit stations percent change from baseline) -2.72 1.07 2.62 4.0 6.62 \u03b1(workplaces percent change from baseline) -8.74 -5.69 -4.29 -2.78 -0.0176 \u03b1(residential percent change from baseline) -1.14 1.99 4.17 6.15 9.99 \u03b1(percentchangebusinesses) 1.76 4.71 6.1 7.62 10.3 \u03b1(constant) -3.77 -1.06 0.153 1.49 5.02 \u03b1(logpopdens) 0.119 0.329 0.453 0.637 1.34 \u03b1(Percent Unemployed 2018 ) 0.0668 0.476 0.688 0.927 2.38 \u03b1(Percent living under the federal poverty line 2018 ) -0.579 -0.35 -0.252 -0.151 0.138 \u03b1(Percent at risk for serious illness due to COVID) -0.197 0.0563 0.105 0.153 0.245","title":"L\u2081 = 1, L\u2082 = 3"},{"location":"rt_longdiff/#l1-1-l2-7","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.104 0.0197 0.000441 0.000482 1040.0 1.0 \u03c3R0 8.77 1.55 0.0346 0.0345 1460.0 1.0 \u03b10(constant) 0.4 3.14 0.0703 0.087 2070.0 1.0 \u03b10(logpopdens) -0.365 1.2 0.0269 0.0285 1740.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.22 1.91 0.0426 0.0439 1750.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.673 0.894 0.02 0.023 1770.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.751 0.352 0.00788 0.00705 2010.0 1.0 \u03c3R 2.33 0.424 0.00949 0.00884 1220.0 1.0 \u03c3k 0.713 0.0128 0.000285 0.000314 2210.0 1.0 \u03c1 0.917 0.01 0.000224 0.000269 2360.0 1.0 \u03b1(Stay at home shelter in place) -3.51 1.21 0.0271 0.0291 1500.0 1.0 \u03b1(Date closed K 12 schools) 2.95 1.37 0.0307 0.0265 1950.0 1.0 \u03b1(Closed gyms) -0.535 1.75 0.0391 0.0351 2620.0 1.0 \u03b1(Closed movie theaters) -0.821 1.82 0.0406 0.0391 2320.0 1.0 \u03b1(Closed day cares) -0.28 1.17 0.0261 0.0297 1650.0 1.0 \u03b1(Date banned visitors to nursing homes) -1.49 1.05 0.0234 0.0228 2130.0 1.0 \u03b1(Closed non essential businesses) -2.18 1.23 0.0276 0.0341 1290.0 1.0 \u03b1(Closed restaurants except take out) 1.19 1.51 0.0337 0.0325 2440.0 1.0 \u03b1(retail and recreation percent change from baseline) -1.37 2.71 0.0605 0.0689 2180.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.06 2.38 0.0532 0.0553 1840.0 1.0 \u03b1(parks percent change from baseline) 0.533 0.9 0.0201 0.0173 2050.0 1.0 \u03b1(transit stations percent change from baseline) 0.492 2.58 0.0577 0.0488 2130.0 1.0 \u03b1(workplaces percent change from baseline) -0.802 2.39 0.0534 0.0459 2140.0 1.0 \u03b1(residential percent change from baseline) 1.76 3.05 0.0681 0.0543 1640.0 1.0 \u03b1(percentchangebusinesses) 1.85 2.47 0.0553 0.0453 2700.0 1.0 \u03b1(constant) 1.06 2.83 0.0633 0.0607 2070.0 1.0 \u03b1(logpopdens) 1.39 0.559 0.0125 0.0119 1520.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.133 0.901 0.0202 0.0223 2000.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.0657 0.385 0.0086 0.00641 2090.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) -0.0798 0.156 0.0035 0.00311 2300.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0728 0.09 0.101 0.115 0.152 \u03c3R0 5.96 7.7 8.66 9.77 11.9 \u03b10(constant) -5.77 -1.72 0.417 2.56 6.5 \u03b10(logpopdens) -2.74 -1.15 -0.384 0.429 1.98 \u03b10(Percent Unemployed 2018 ) -2.4 -0.112 1.18 2.52 4.95 \u03b10(Percent living under the federal poverty line 2018 ) -2.44 -1.26 -0.682 -0.0941 1.1 \u03b10(Percent at risk for serious illness due to COVID) 0.0927 0.52 0.734 0.966 1.49 \u03c3R 1.56 2.04 2.32 2.61 3.2 \u03c3k 0.688 0.704 0.713 0.722 0.738 \u03c1 0.896 0.91 0.917 0.924 0.936 \u03b1(Stay at home shelter in place) -5.96 -4.29 -3.44 -2.67 -1.25 \u03b1(Date closed K 12 schools) 0.372 2.05 2.88 3.83 5.83 \u03b1(Closed gyms) -3.96 -1.7 -0.519 0.673 2.86 \u03b1(Closed movie theaters) -4.44 -2.03 -0.808 0.451 2.59 \u03b1(Closed day cares) -2.52 -1.05 -0.266 0.504 2.04 \u03b1(Date banned visitors to nursing homes) -3.53 -2.19 -1.49 -0.751 0.506 \u03b1(Closed non essential businesses) -4.74 -2.95 -2.11 -1.34 0.0364 \u03b1(Closed restaurants except take out) -1.75 0.171 1.19 2.2 4.13 \u03b1(retail and recreation percent change from baseline) -6.68 -3.23 -1.31 0.473 3.79 \u03b1(grocery and pharmacy percent change from baseline) -5.76 -2.7 -1.04 0.52 3.64 \u03b1(parks percent change from baseline) -1.18 -0.0583 0.514 1.12 2.37 \u03b1(transit stations percent change from baseline) -4.63 -1.27 0.487 2.24 5.49 \u03b1(workplaces percent change from baseline) -5.33 -2.44 -0.855 0.775 3.88 \u03b1(residential percent change from baseline) -4.35 -0.17 1.79 3.76 7.77 \u03b1(percentchangebusinesses) -3.0 0.16 1.89 3.55 6.55 \u03b1(constant) -4.43 -0.815 1.04 2.99 6.55 \u03b1(logpopdens) 0.375 1.01 1.35 1.73 2.61 \u03b1(Percent Unemployed 2018 ) -1.69 -0.463 0.134 0.746 1.9 \u03b1(Percent living under the federal poverty line 2018 ) -0.84 -0.314 -0.054 0.184 0.682 \u03b1(Percent at risk for serious illness due to COVID) -0.396 -0.177 -0.0822 0.0231 0.229","title":"L\u2081 = 1, L\u2082 = 7"},{"location":"rt_longdiff/#l1-3-l2-1","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.0869 0.0176 0.000393 0.000766 437.0 1.0 \u03c3R0 11.2 1.92 0.0429 0.0762 562.0 1.0 \u03b10(constant) 0.16 3.18 0.0711 0.0827 1430.0 1.0 \u03b10(logpopdens) 0.65 3.06 0.0684 0.0759 1960.0 1.0 \u03b10(Percent Unemployed 2018 ) 0.534 3.07 0.0686 0.0697 1650.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) 0.85 2.92 0.0653 0.054 1440.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 2.52 1.66 0.037 0.0363 1210.0 1.0 \u03c3R 0.807 0.57 0.0128 0.0238 520.0 1.0 \u03c3k 0.23 0.0133 0.000298 0.000788 243.0 1.01 \u03c1 0.0669 0.0279 0.000623 0.000474 1260.0 1.0 \u03b1(Stay at home shelter in place) -0.915 0.321 0.00718 0.0112 1070.0 1.0 \u03b1(Date closed K 12 schools) 0.239 0.382 0.00854 0.00689 2330.0 1.0 \u03b1(Closed gyms) -0.373 0.483 0.0108 0.00748 2100.0 1.0 \u03b1(Closed movie theaters) -0.0107 0.497 0.0111 0.00797 1930.0 1.0 \u03b1(Closed day cares) -0.0175 0.235 0.00527 0.00646 1360.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.102 0.197 0.00441 0.00438 2300.0 1.0 \u03b1(Closed non essential businesses) -0.473 0.288 0.00644 0.00715 1480.0 1.0 \u03b1(Closed restaurants except take out) 0.0633 0.419 0.00938 0.00819 1970.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.279 1.3 0.0291 0.0314 1970.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.79 1.09 0.0243 0.0278 1810.0 1.0 \u03b1(parks percent change from baseline) -0.0168 0.273 0.0061 0.00616 2160.0 1.0 \u03b1(transit stations percent change from baseline) 1.92 1.15 0.0258 0.0348 1690.0 1.0 \u03b1(workplaces percent change from baseline) -1.11 1.62 0.0363 0.0469 1390.0 1.0 \u03b1(residential percent change from baseline) 6.07 2.57 0.0575 0.065 1790.0 1.0 \u03b1(percentchangebusinesses) 2.67 1.34 0.0299 0.0378 1200.0 1.0 \u03b1(constant) 0.00546 1.1 0.0246 0.0303 1430.0 1.0 \u03b1(logpopdens) 0.218 0.0815 0.00182 0.00217 1420.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.365 0.149 0.00333 0.00469 1330.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.156 0.0648 0.00145 0.00191 1340.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0701 0.0335 0.000748 0.000981 1240.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0585 0.0743 0.0847 0.0971 0.128 \u03c3R0 7.76 9.82 11.1 12.5 15.2 \u03b10(constant) -6.3 -1.97 0.152 2.3 6.12 \u03b10(logpopdens) -5.3 -1.47 0.647 2.7 6.83 \u03b10(Percent Unemployed 2018 ) -5.5 -1.51 0.592 2.6 6.32 \u03b10(Percent living under the federal poverty line 2018 ) -4.77 -1.13 0.809 2.9 6.55 \u03b10(Percent at risk for serious illness due to COVID) -0.315 1.37 2.41 3.49 6.15 \u03c3R 0.0395 0.347 0.701 1.15 2.17 \u03c3k 0.196 0.227 0.233 0.237 0.242 \u03c1 0.0231 0.0461 0.0638 0.0846 0.128 \u03b1(Stay at home shelter in place) -1.66 -1.11 -0.869 -0.685 -0.396 \u03b1(Date closed K 12 schools) -0.5 -0.0105 0.228 0.467 1.04 \u03b1(Closed gyms) -1.39 -0.671 -0.353 -0.0651 0.585 \u03b1(Closed movie theaters) -0.942 -0.333 -0.0111 0.298 0.971 \u03b1(Closed day cares) -0.469 -0.172 -0.0223 0.139 0.462 \u03b1(Date banned visitors to nursing homes) -0.511 -0.232 -0.0923 0.0347 0.271 \u03b1(Closed non essential businesses) -1.1 -0.644 -0.451 -0.271 0.0107 \u03b1(Closed restaurants except take out) -0.743 -0.201 0.0579 0.34 0.921 \u03b1(retail and recreation percent change from baseline) -2.88 -1.12 -0.274 0.562 2.34 \u03b1(grocery and pharmacy percent change from baseline) -0.234 1.06 1.74 2.46 4.03 \u03b1(parks percent change from baseline) -0.577 -0.186 -0.0108 0.161 0.494 \u03b1(transit stations percent change from baseline) -0.194 1.15 1.91 2.6 4.33 \u03b1(workplaces percent change from baseline) -4.64 -2.18 -1.07 0.00594 1.92 \u03b1(residential percent change from baseline) 1.01 4.3 6.1 7.84 11.1 \u03b1(percentchangebusinesses) 0.187 1.75 2.59 3.5 5.51 \u03b1(constant) -2.13 -0.683 0.024 0.712 2.15 \u03b1(logpopdens) 0.0712 0.161 0.212 0.27 0.389 \u03b1(Percent Unemployed 2018 ) 0.113 0.261 0.352 0.454 0.691 \u03b1(Percent living under the federal poverty line 2018 ) -0.297 -0.199 -0.149 -0.109 -0.0489 \u03b1(Percent at risk for serious illness due to COVID) 0.00903 0.0469 0.0681 0.0913 0.14","title":"L\u2081 = 3, L\u2082 = 1"},{"location":"rt_longdiff/#l1-3-l2-3","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.163 0.0254 0.000569 0.00059 976.0 1.0 \u03c3R0 9.23 1.44 0.0322 0.0238 1330.0 1.0 \u03b10(constant) 0.666 3.3 0.0737 0.0606 2930.0 1.0 \u03b10(logpopdens) -0.818 1.46 0.0326 0.0308 2820.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.94 2.05 0.0458 0.0458 2600.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -1.03 1.08 0.0241 0.0247 2490.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.402 0.389 0.00869 0.00776 2530.0 1.0 \u03c3R 3.25 0.488 0.0109 0.0104 1040.0 1.0 \u03c3k 0.0176 0.0134 0.000299 0.000358 2350.0 1.0 \u03c1 0.557 0.0159 0.000356 0.000227 2330.0 1.0 \u03b1(Stay at home shelter in place) -1.47 0.448 0.01 0.00838 2190.0 1.0 \u03b1(Date closed K 12 schools) -0.247 0.478 0.0107 0.00647 2660.0 1.0 \u03b1(Closed gyms) -0.738 0.704 0.0157 0.0105 2640.0 1.0 \u03b1(Closed movie theaters) -0.12 0.735 0.0164 0.0108 2540.0 1.0 \u03b1(Closed day cares) -0.259 0.381 0.00851 0.00694 3330.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.273 0.32 0.00715 0.00645 2400.0 1.0 \u03b1(Closed non essential businesses) -0.354 0.397 0.00887 0.00771 2350.0 1.0 \u03b1(Closed restaurants except take out) 0.253 0.547 0.0122 0.0101 2790.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.297 1.61 0.0359 0.0331 2750.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) 1.69 1.28 0.0287 0.0365 2700.0 1.0 \u03b1(parks percent change from baseline) -0.178 0.303 0.00677 0.00696 2550.0 1.0 \u03b1(transit stations percent change from baseline) 2.46 1.46 0.0327 0.0293 2560.0 1.0 \u03b1(workplaces percent change from baseline) 1.25 1.52 0.0339 0.0296 2810.0 0.999 \u03b1(residential percent change from baseline) 4.02 2.49 0.0556 0.0498 3260.0 1.0 \u03b1(percentchangebusinesses) -0.116 1.16 0.026 0.0235 3050.0 1.0 \u03b1(constant) 1.5 1.61 0.0361 0.0292 2460.0 1.0 \u03b1(logpopdens) 0.329 0.138 0.00309 0.00234 2710.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.386 0.241 0.00539 0.00391 2950.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.188 0.101 0.00226 0.00146 2890.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0751 0.0501 0.00112 0.000779 2560.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.122 0.145 0.16 0.177 0.223 \u03c3R0 6.55 8.23 9.2 10.1 12.2 \u03b10(constant) -5.74 -1.56 0.664 2.9 7.24 \u03b10(logpopdens) -3.62 -1.85 -0.808 0.217 2.0 \u03b10(Percent Unemployed 2018 ) -1.99 0.565 1.95 3.34 5.9 \u03b10(Percent living under the federal poverty line 2018 ) -3.19 -1.73 -1.04 -0.309 1.11 \u03b10(Percent at risk for serious illness due to COVID) -0.359 0.152 0.394 0.671 1.21 \u03c3R 2.34 2.91 3.22 3.57 4.24 \u03c3k 0.000796 0.00682 0.0146 0.0248 0.05 \u03c1 0.525 0.547 0.557 0.568 0.588 \u03b1(Stay at home shelter in place) -2.38 -1.78 -1.44 -1.14 -0.684 \u03b1(Date closed K 12 schools) -1.18 -0.569 -0.228 0.0672 0.653 \u03b1(Closed gyms) -2.14 -1.19 -0.74 -0.27 0.646 \u03b1(Closed movie theaters) -1.59 -0.625 -0.116 0.383 1.3 \u03b1(Closed day cares) -1.01 -0.515 -0.248 0.000724 0.493 \u03b1(Date banned visitors to nursing homes) -0.961 -0.473 -0.257 -0.0551 0.329 \u03b1(Closed non essential businesses) -1.18 -0.592 -0.336 -0.0883 0.382 \u03b1(Closed restaurants except take out) -0.8 -0.113 0.239 0.617 1.36 \u03b1(retail and recreation percent change from baseline) -3.4 -1.38 -0.296 0.762 2.8 \u03b1(grocery and pharmacy percent change from baseline) -0.786 0.836 1.67 2.51 4.18 \u03b1(parks percent change from baseline) -0.811 -0.369 -0.171 0.0251 0.405 \u03b1(transit stations percent change from baseline) -0.239 1.44 2.46 3.47 5.39 \u03b1(workplaces percent change from baseline) -1.71 0.195 1.27 2.31 4.26 \u03b1(residential percent change from baseline) -0.874 2.31 4.07 5.72 8.8 \u03b1(percentchangebusinesses) -2.4 -0.896 -0.0914 0.667 2.19 \u03b1(constant) -1.72 0.437 1.5 2.58 4.61 \u03b1(logpopdens) 0.0734 0.237 0.32 0.414 0.626 \u03b1(Percent Unemployed 2018 ) -0.0826 0.223 0.383 0.544 0.866 \u03b1(Percent living under the federal poverty line 2018 ) -0.396 -0.252 -0.187 -0.12 -0.000843 \u03b1(Percent at risk for serious illness due to COVID) -0.0203 0.0411 0.0736 0.108 0.177","title":"L\u2081 = 3, L\u2082 = 3"},{"location":"rt_longdiff/#l1-3-l2-7","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.167 0.0275 0.000615 0.00109 783.0 1.0 \u03c3R0 8.23 1.4 0.0314 0.0541 795.0 1.0 \u03b10(constant) 1.23 3.06 0.0683 0.0557 3170.0 1.0 \u03b10(logpopdens) -1.22 1.01 0.0227 0.0273 1870.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.5 1.65 0.0369 0.0311 2110.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.252 0.732 0.0164 0.0126 2300.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.331 0.26 0.00582 0.00623 2130.0 1.0 \u03c3R 3.06 0.49 0.011 0.0205 785.0 1.0 \u03c3k 0.0403 0.0251 0.000562 0.000468 1680.0 1.0 \u03c1 0.832 0.0126 0.000282 0.000364 2060.0 1.0 \u03b1(Stay at home shelter in place) -1.34 0.604 0.0135 0.0141 1990.0 1.0 \u03b1(Date closed K 12 schools) 0.736 0.574 0.0128 0.00813 2840.0 1.0 \u03b1(Closed gyms) -1.47 0.963 0.0215 0.0234 2540.0 1.0 \u03b1(Closed movie theaters) 0.346 0.993 0.0222 0.0231 2540.0 1.0 \u03b1(Closed day cares) -0.226 0.644 0.0144 0.0177 2210.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.471 0.581 0.013 0.0125 2140.0 1.0 \u03b1(Closed non essential businesses) -0.0801 0.608 0.0136 0.0106 3040.0 1.0 \u03b1(Closed restaurants except take out) 1.1 0.702 0.0157 0.0167 2690.0 1.0 \u03b1(retail and recreation percent change from baseline) 6.21 1.82 0.0408 0.0347 2320.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.22 1.51 0.0338 0.0232 2920.0 1.0 \u03b1(parks percent change from baseline) -0.643 0.325 0.00728 0.0054 2660.0 1.0 \u03b1(transit stations percent change from baseline) 0.246 1.76 0.0393 0.0313 2440.0 1.0 \u03b1(workplaces percent change from baseline) 1.25 1.6 0.0357 0.0291 2440.0 1.0 \u03b1(residential percent change from baseline) -0.192 2.42 0.0542 0.0537 3030.0 1.0 \u03b1(percentchangebusinesses) 0.165 1.09 0.0244 0.0314 2400.0 1.0 \u03b1(constant) 3.23 2.54 0.0567 0.0335 3500.0 1.0 \u03b1(logpopdens) 0.947 0.333 0.00746 0.00574 2220.0 1.0 \u03b1(Percent Unemployed 2018 ) -0.165 0.534 0.0119 0.0135 2280.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.112 0.239 0.00534 0.00487 2250.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0546 0.0998 0.00223 0.00124 2620.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.124 0.147 0.164 0.184 0.229 \u03c3R0 5.7 7.26 8.13 9.16 11.2 \u03b10(constant) -4.45 -0.916 1.25 3.27 7.17 \u03b10(logpopdens) -3.22 -1.9 -1.21 -0.521 0.723 \u03b10(Percent Unemployed 2018 ) -1.76 0.403 1.48 2.6 4.79 \u03b10(Percent living under the federal poverty line 2018 ) -1.74 -0.742 -0.238 0.223 1.23 \u03b10(Percent at risk for serious illness due to COVID) -0.147 0.152 0.318 0.491 0.868 \u03c3R 2.18 2.72 3.04 3.39 4.01 \u03c3k 0.00208 0.0195 0.038 0.0595 0.0902 \u03c1 0.807 0.823 0.832 0.84 0.856 \u03b1(Stay at home shelter in place) -2.58 -1.73 -1.31 -0.916 -0.189 \u03b1(Date closed K 12 schools) -0.402 0.369 0.721 1.11 1.94 \u03b1(Closed gyms) -3.47 -2.08 -1.46 -0.813 0.384 \u03b1(Closed movie theaters) -1.59 -0.332 0.343 1.02 2.31 \u03b1(Closed day cares) -1.52 -0.659 -0.205 0.21 0.98 \u03b1(Date banned visitors to nursing homes) -1.62 -0.846 -0.479 -0.0873 0.651 \u03b1(Closed non essential businesses) -1.28 -0.482 -0.0713 0.317 1.07 \u03b1(Closed restaurants except take out) -0.203 0.61 1.07 1.57 2.49 \u03b1(retail and recreation percent change from baseline) 2.73 4.96 6.18 7.36 9.92 \u03b1(grocery and pharmacy percent change from baseline) -4.02 -2.25 -1.24 -0.218 1.83 \u03b1(parks percent change from baseline) -1.33 -0.855 -0.633 -0.417 -0.0281 \u03b1(transit stations percent change from baseline) -3.3 -0.931 0.249 1.39 3.68 \u03b1(workplaces percent change from baseline) -1.77 0.165 1.22 2.34 4.42 \u03b1(residential percent change from baseline) -4.87 -1.84 -0.19 1.43 4.55 \u03b1(percentchangebusinesses) -2.03 -0.558 0.166 0.856 2.27 \u03b1(constant) -1.91 1.51 3.24 4.94 8.12 \u03b1(logpopdens) 0.344 0.717 0.935 1.16 1.63 \u03b1(Percent Unemployed 2018 ) -1.19 -0.524 -0.17 0.177 0.906 \u03b1(Percent living under the federal poverty line 2018 ) -0.609 -0.261 -0.105 0.0448 0.343 \u03b1(Percent at risk for serious illness due to COVID) -0.14 -0.0102 0.0541 0.117 0.255","title":"L\u2081 = 3, L\u2082 = 7"},{"location":"rt_longdiff/#l1-7-l2-1","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.0728 0.0167 0.000373 0.000824 414.0 1.0 \u03c3R0 8.25 1.72 0.0385 0.0688 572.0 1.0 \u03b10(constant) 0.0816 3.16 0.0706 0.0533 2840.0 1.0 \u03b10(logpopdens) 0.369 3.11 0.0695 0.069 2470.0 1.0 \u03b10(Percent Unemployed 2018 ) 0.298 3.1 0.0693 0.0618 2330.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.159 2.56 0.0573 0.0641 2300.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 1.0 1.11 0.0248 0.0263 2150.0 1.0 \u03c3R 2.37 0.529 0.0118 0.0176 730.0 1.01 \u03c3k 0.0698 0.033 0.000738 0.00142 649.0 1.0 \u03c1 0.0933 0.0332 0.000743 0.00118 896.0 1.0 \u03b1(Stay at home shelter in place) -1.17 0.348 0.00778 0.0114 740.0 1.0 \u03b1(Date closed K 12 schools) 0.00193 0.29 0.00648 0.00666 2220.0 1.0 \u03b1(Closed gyms) -0.34 0.38 0.0085 0.0102 2160.0 1.0 \u03b1(Closed movie theaters) 0.0138 0.394 0.00882 0.00846 2060.0 1.0 \u03b1(Closed day cares) -0.192 0.176 0.00393 0.00417 1560.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.139 0.156 0.00348 0.00237 2030.0 1.0 \u03b1(Closed non essential businesses) -0.6 0.243 0.00543 0.00817 852.0 1.0 \u03b1(Closed restaurants except take out) 0.119 0.336 0.00751 0.00705 2590.0 1.0 \u03b1(retail and recreation percent change from baseline) -0.382 1.07 0.0239 0.0208 1970.0 0.999 \u03b1(grocery and pharmacy percent change from baseline) 0.285 0.823 0.0184 0.0158 2390.0 1.0 \u03b1(parks percent change from baseline) 0.0582 0.214 0.00478 0.00499 2200.0 1.0 \u03b1(transit stations percent change from baseline) 2.49 1.0 0.0224 0.0249 1470.0 1.0 \u03b1(workplaces percent change from baseline) 1.49 1.4 0.0313 0.0309 1750.0 1.0 \u03b1(residential percent change from baseline) 8.64 2.33 0.0521 0.0481 2580.0 1.0 \u03b1(percentchangebusinesses) 1.2 1.07 0.0239 0.0221 1760.0 1.0 \u03b1(constant) 0.334 0.896 0.02 0.0169 2340.0 1.0 \u03b1(logpopdens) 0.281 0.0875 0.00196 0.00275 738.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.396 0.134 0.003 0.00394 1110.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.155 0.0583 0.0013 0.00168 1050.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0706 0.03 0.000671 0.000877 1250.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0472 0.0608 0.0703 0.0823 0.111 \u03c3R0 5.21 6.99 8.14 9.37 11.9 \u03b10(constant) -5.83 -2.14 0.00505 2.23 6.23 \u03b10(logpopdens) -5.74 -1.71 0.355 2.48 6.48 \u03b10(Percent Unemployed 2018 ) -5.75 -1.83 0.21 2.43 6.08 \u03b10(Percent living under the federal poverty line 2018 ) -5.33 -1.84 -0.0771 1.58 4.86 \u03b10(Percent at risk for serious illness due to COVID) -1.0 0.23 0.947 1.69 3.34 \u03c3R 1.42 1.99 2.35 2.71 3.51 \u03c3k 0.00518 0.0445 0.0748 0.0954 0.122 \u03c1 0.0362 0.0702 0.0895 0.112 0.171 \u03b1(Stay at home shelter in place) -1.96 -1.37 -1.12 -0.929 -0.609 \u03b1(Date closed K 12 schools) -0.579 -0.186 0.00493 0.191 0.569 \u03b1(Closed gyms) -1.13 -0.583 -0.32 -0.0895 0.377 \u03b1(Closed movie theaters) -0.779 -0.249 0.00973 0.27 0.806 \u03b1(Closed day cares) -0.56 -0.298 -0.181 -0.0718 0.132 \u03b1(Date banned visitors to nursing homes) -0.47 -0.232 -0.13 -0.0412 0.159 \u03b1(Closed non essential businesses) -1.12 -0.759 -0.572 -0.423 -0.18 \u03b1(Closed restaurants except take out) -0.559 -0.0996 0.115 0.342 0.783 \u03b1(retail and recreation percent change from baseline) -2.55 -1.09 -0.372 0.337 1.68 \u03b1(grocery and pharmacy percent change from baseline) -1.33 -0.252 0.272 0.815 1.92 \u03b1(parks percent change from baseline) -0.367 -0.0798 0.0616 0.195 0.474 \u03b1(transit stations percent change from baseline) 0.782 1.79 2.41 3.13 4.61 \u03b1(workplaces percent change from baseline) -1.44 0.597 1.57 2.43 4.02 \u03b1(residential percent change from baseline) 3.95 7.11 8.65 10.2 13.2 \u03b1(percentchangebusinesses) -0.73 0.464 1.14 1.86 3.51 \u03b1(constant) -1.54 -0.239 0.357 0.918 2.06 \u03b1(logpopdens) 0.14 0.218 0.273 0.333 0.482 \u03b1(Percent Unemployed 2018 ) 0.167 0.303 0.382 0.48 0.691 \u03b1(Percent living under the federal poverty line 2018 ) -0.283 -0.194 -0.151 -0.113 -0.0581 \u03b1(Percent at risk for serious illness due to COVID) 0.019 0.0487 0.0681 0.0891 0.136","title":"L\u2081 = 7, L\u2082 = 1"},{"location":"rt_longdiff/#l1-7-l2-3","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.0881 0.014 0.000313 0.000405 907.0 1.0 \u03c3R0 8.6 1.39 0.0311 0.0358 1080.0 0.999 \u03b10(constant) 0.218 3.07 0.0687 0.0833 1840.0 1.0 \u03b10(logpopdens) -0.244 1.11 0.0247 0.0246 1790.0 1.0 \u03b10(Percent Unemployed 2018 ) -0.363 1.73 0.0387 0.0415 1870.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.348 0.826 0.0185 0.018 2000.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.41 0.289 0.00647 0.0083 2090.0 1.0 \u03c3R 3.19 0.498 0.0111 0.0138 912.0 1.0 \u03c3k 0.0123 0.00903 0.000202 0.000211 1440.0 1.0 \u03c1 0.738 0.0139 0.000311 0.000351 2830.0 1.0 \u03b1(Stay at home shelter in place) -1.79 0.572 0.0128 0.00956 1620.0 1.0 \u03b1(Date closed K 12 schools) -0.0229 0.563 0.0126 0.0138 2210.0 1.0 \u03b1(Closed gyms) -0.911 0.876 0.0196 0.0132 2170.0 1.0 \u03b1(Closed movie theaters) -0.0547 0.929 0.0208 0.0121 2060.0 1.0 \u03b1(Closed day cares) -0.452 0.562 0.0126 0.0133 1480.0 1.0 \u03b1(Date banned visitors to nursing homes) -0.573 0.479 0.0107 0.0128 1660.0 1.0 \u03b1(Closed non essential businesses) -0.382 0.522 0.0117 0.0115 2050.0 1.0 \u03b1(Closed restaurants except take out) 0.671 0.714 0.016 0.0134 2060.0 1.0 \u03b1(retail and recreation percent change from baseline) 0.585 1.78 0.0397 0.0395 1690.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -1.79 1.44 0.0321 0.0395 1950.0 1.0 \u03b1(parks percent change from baseline) -0.101 0.323 0.00723 0.00647 2030.0 1.0 \u03b1(transit stations percent change from baseline) 3.92 1.74 0.039 0.0417 2060.0 1.0 \u03b1(workplaces percent change from baseline) 1.95 1.61 0.036 0.043 1790.0 1.0 \u03b1(residential percent change from baseline) 2.85 2.5 0.0558 0.0606 2020.0 1.0 \u03b1(percentchangebusinesses) 0.364 1.13 0.0253 0.0256 2220.0 1.0 \u03b1(constant) 2.52 2.2 0.0493 0.0455 1830.0 1.0 \u03b1(logpopdens) 0.736 0.241 0.00539 0.00499 2000.0 1.0 \u03b1(Percent Unemployed 2018 ) 0.409 0.402 0.00898 0.00841 2030.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) -0.207 0.167 0.00372 0.00353 1960.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) 0.0677 0.0729 0.00163 0.00173 1830.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0642 0.0779 0.0868 0.0966 0.12 \u03c3R0 6.03 7.65 8.49 9.52 11.4 \u03b10(constant) -5.77 -1.83 0.261 2.36 6.02 \u03b10(logpopdens) -2.37 -0.998 -0.266 0.509 2.01 \u03b10(Percent Unemployed 2018 ) -3.79 -1.54 -0.397 0.845 2.87 \u03b10(Percent living under the federal poverty line 2018 ) -1.95 -0.895 -0.345 0.17 1.33 \u03b10(Percent at risk for serious illness due to COVID) -0.15 0.212 0.399 0.6 0.996 \u03c3R 2.28 2.84 3.15 3.51 4.27 \u03c3k 0.000396 0.00502 0.0106 0.018 0.0333 \u03c1 0.71 0.728 0.737 0.747 0.765 \u03b1(Stay at home shelter in place) -3.0 -2.16 -1.75 -1.4 -0.761 \u03b1(Date closed K 12 schools) -1.16 -0.385 -0.0234 0.36 1.03 \u03b1(Closed gyms) -2.62 -1.51 -0.902 -0.3 0.763 \u03b1(Closed movie theaters) -1.93 -0.631 -0.0647 0.567 1.78 \u03b1(Closed day cares) -1.61 -0.799 -0.451 -0.0914 0.636 \u03b1(Date banned visitors to nursing homes) -1.55 -0.873 -0.554 -0.249 0.298 \u03b1(Closed non essential businesses) -1.43 -0.721 -0.381 -0.0303 0.688 \u03b1(Closed restaurants except take out) -0.692 0.191 0.669 1.13 2.11 \u03b1(retail and recreation percent change from baseline) -2.87 -0.591 0.561 1.8 4.02 \u03b1(grocery and pharmacy percent change from baseline) -4.59 -2.76 -1.79 -0.808 0.961 \u03b1(parks percent change from baseline) -0.77 -0.315 -0.0967 0.119 0.519 \u03b1(transit stations percent change from baseline) 0.535 2.75 3.91 5.1 7.31 \u03b1(workplaces percent change from baseline) -1.35 0.872 1.95 3.07 4.95 \u03b1(residential percent change from baseline) -2.15 1.2 2.82 4.51 7.77 \u03b1(percentchangebusinesses) -1.87 -0.391 0.373 1.11 2.57 \u03b1(constant) -1.7 1.05 2.48 3.97 6.86 \u03b1(logpopdens) 0.306 0.569 0.717 0.889 1.24 \u03b1(Percent Unemployed 2018 ) -0.351 0.143 0.402 0.662 1.22 \u03b1(Percent living under the federal poverty line 2018 ) -0.536 -0.312 -0.205 -0.0934 0.118 \u03b1(Percent at risk for serious illness due to COVID) -0.0734 0.0181 0.0673 0.116 0.216","title":"L\u2081 = 7, L\u2082 = 3"},{"location":"rt_longdiff/#l1-7-l2-7","text":"parameters mean std naive_se mcse ess r_hat \u03b3 0.127 0.0233 0.000522 0.000711 734.0 1.0 \u03c3R0 7.85 1.46 0.0326 0.0386 987.0 1.0 \u03b10(constant) 0.736 2.97 0.0665 0.0491 2800.0 1.0 \u03b10(logpopdens) 0.00781 0.98 0.0219 0.0229 2420.0 1.0 \u03b10(Percent Unemployed 2018 ) 1.04 1.54 0.0345 0.0391 2400.0 1.0 \u03b10(Percent living under the federal poverty line 2018 ) -0.772 0.705 0.0158 0.0155 2560.0 1.0 \u03b10(Percent at risk for serious illness due to COVID) 0.53 0.263 0.00587 0.00469 2770.0 1.0 \u03c3R 2.51 0.449 0.01 0.0131 835.0 1.0 \u03c3k 0.081 0.0101 0.000225 0.000244 2140.0 1.0 \u03c1 0.911 0.00845 0.000189 0.000225 2100.0 1.0 \u03b1(Stay at home shelter in place) -0.556 0.551 0.0123 0.00821 2940.0 1.0 \u03b1(Date closed K 12 schools) 0.955 0.687 0.0154 0.0127 3000.0 1.0 \u03b1(Closed gyms) 0.52 0.987 0.0221 0.0189 3030.0 1.0 \u03b1(Closed movie theaters) -0.228 1.03 0.023 0.0198 3480.0 1.0 \u03b1(Closed day cares) 0.123 0.747 0.0167 0.0119 3120.0 1.0 \u03b1(Date banned visitors to nursing homes) -1.32 0.759 0.017 0.0154 2510.0 1.0 \u03b1(Closed non essential businesses) -0.0478 0.61 0.0136 0.0103 3100.0 1.0 \u03b1(Closed restaurants except take out) 0.728 0.786 0.0176 0.0158 3140.0 1.0 \u03b1(retail and recreation percent change from baseline) 5.62 1.91 0.0427 0.0287 2940.0 1.0 \u03b1(grocery and pharmacy percent change from baseline) -5.41 1.57 0.0352 0.0263 2940.0 1.0 \u03b1(parks percent change from baseline) -0.21 0.306 0.00684 0.00687 2940.0 1.0 \u03b1(transit stations percent change from baseline) 3.05 1.81 0.0405 0.0321 3030.0 1.0 \u03b1(workplaces percent change from baseline) 1.69 1.57 0.0352 0.0286 3020.0 1.0 \u03b1(residential percent change from baseline) 0.79 2.33 0.0521 0.0453 2790.0 1.0 \u03b1(percentchangebusinesses) 0.313 0.961 0.0215 0.0206 2790.0 1.0 \u03b1(constant) 3.28 2.87 0.0641 0.0608 3010.0 1.0 \u03b1(logpopdens) 1.33 0.522 0.0117 0.0104 2820.0 1.0 \u03b1(Percent Unemployed 2018 ) -0.517 0.822 0.0184 0.0172 2730.0 1.0 \u03b1(Percent living under the federal poverty line 2018 ) 0.0748 0.338 0.00757 0.0058 2960.0 1.0 \u03b1(Percent at risk for serious illness due to COVID) -0.0575 0.133 0.00297 0.00266 2780.0 1.0 parameters 2.5% 25.0% 50.0% 75.0% 97.5% \u03b3 0.0899 0.11 0.124 0.141 0.179 \u03c3R0 5.3 6.81 7.78 8.79 10.9 \u03b10(constant) -5.04 -1.3 0.747 2.83 6.46 \u03b10(logpopdens) -1.92 -0.639 0.0109 0.627 1.98 \u03b10(Percent Unemployed 2018 ) -1.86 -0.00685 0.992 2.09 4.08 \u03b10(Percent living under the federal poverty line 2018 ) -2.23 -1.25 -0.749 -0.279 0.612 \u03b10(Percent at risk for serious illness due to COVID) 0.0392 0.357 0.517 0.693 1.07 \u03c3R 1.73 2.2 2.48 2.82 3.46 \u03c3k 0.0596 0.0748 0.0817 0.088 0.0988 \u03c1 0.894 0.905 0.911 0.916 0.927 \u03b1(Stay at home shelter in place) -1.69 -0.899 -0.549 -0.18 0.47 \u03b1(Date closed K 12 schools) -0.308 0.489 0.945 1.4 2.35 \u03b1(Closed gyms) -1.41 -0.112 0.513 1.12 2.55 \u03b1(Closed movie theaters) -2.31 -0.902 -0.223 0.455 1.84 \u03b1(Closed day cares) -1.3 -0.36 0.113 0.61 1.63 \u03b1(Date banned visitors to nursing homes) -2.86 -1.78 -1.3 -0.809 0.0802 \u03b1(Closed non essential businesses) -1.32 -0.452 -0.0337 0.36 1.13 \u03b1(Closed restaurants except take out) -0.727 0.192 0.726 1.25 2.33 \u03b1(retail and recreation percent change from baseline) 1.94 4.38 5.61 6.86 9.43 \u03b1(grocery and pharmacy percent change from baseline) -8.57 -6.45 -5.39 -4.34 -2.48 \u03b1(parks percent change from baseline) -0.842 -0.409 -0.205 -0.014 0.393 \u03b1(transit stations percent change from baseline) -0.483 1.83 3.08 4.25 6.6 \u03b1(workplaces percent change from baseline) -1.52 0.7 1.71 2.71 4.73 \u03b1(residential percent change from baseline) -3.76 -0.743 0.777 2.38 5.33 \u03b1(percentchangebusinesses) -1.51 -0.332 0.258 0.952 2.28 \u03b1(constant) -2.27 1.36 3.4 5.27 8.53 \u03b1(logpopdens) 0.411 0.965 1.3 1.67 2.45 \u03b1(Percent Unemployed 2018 ) -2.06 -1.07 -0.529 0.0268 1.05 \u03b1(Percent living under the federal poverty line 2018 ) -0.589 -0.141 0.0723 0.294 0.768 \u03b1(Percent at risk for serious illness due to COVID) -0.318 -0.144 -0.0618 0.0276 0.206","title":"L\u2081 = 7, L\u2082 = 7"}]}